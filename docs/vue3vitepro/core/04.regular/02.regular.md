# æ­£åˆ™æ ¡éªŒå®æˆ˜

## æ­£åˆ™æ ¡éªŒé¡µé¢

å¼€å§‹å†™ä»£ç äº†ï¼Œå…ˆåšä¸‹å‡†å¤‡å·¥ä½œï¼Œä¹‹å‰æˆ‘ä»¬å·²ç»åœ¨ `src/views` æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºäº†æ­£åˆ™åŒ¹é…é¡µé¢ `RegularPage.vue`ï¼Œç°åœ¨æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ï¼ŒæŠŠè¿™ä¸ªé¡µé¢ä¿®æ”¹ä¸º `RegularPage/index.vue`ï¼Œå› ä¸ºåé¢æˆ‘ä»¬è¦å†™ä¸ªæ­£åˆ™å¯è§†åŒ–é¢„è§ˆçš„ç»„ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œå…ˆæŠŠæ­£åˆ™æ ¡éªŒé¡µé¢æ”¹æˆæ–‡ä»¶å¤¹ï¼Œé‚£è¿™é‡Œæ”¹äº†ï¼Œè·¯ç”±é¡µé¢ä¹Ÿéœ€è¦æ”¹ä¸€ä¸‹ï¼Œä¿®æ”¹ `src/router/menuRouter.js` æ–‡ä»¶å¦‚ä¸‹ï¼š

```jsx
import IconMaterialSymbolsCodeBlocksOutline from '~icons/material-symbols/code-blocks-outline'

export const menuRouter = [
  {
    path: 'devtools',
    name: 'DevTools',
    meta: {
      title: 'å¼€å‘å·¥å…·',
      icon: markRaw(IconMaterialSymbolsCodeBlocksOutline)
    },
    redirect: { name: 'RegularPage' },
    children: [
      {
        path: 'regular',
        name: 'RegularPage',
        meta: {
          title: 'æ­£åˆ™åœ¨çº¿æ ¡éªŒ'
        },
				// ä¿®æ”¹å¦‚ä¸‹
        component: () => import('@/views/RegularPage/index.vue')
        // component: () => import('@/views/RegularPage.vue')
      }
    ]
  }
]

// ...
```

OKï¼Œå†æ¬¡åˆ·æ–°é¡µé¢æ²¡é—®é¢˜çš„è¯å°±å¯ä»¥ç»§ç»­äº†ï¼

## å‡†å¤‡æ­£åˆ™é¢„è®¾

ä¹‹å‰æˆ‘ä»¬ä¹Ÿè¯´äº†ï¼Œè¦å†™ä¸€äº›é¢„è®¾çš„æ­£åˆ™è®©ç”¨æˆ·å¯ä»¥ç›´æ¥æœæ­£åˆ™åŠŸèƒ½ååŒ¹é…ï¼Œé‚£å†™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å‡†å¤‡ä¸€ä¸‹è¿™äº›é¢„è®¾çš„æ­£åˆ™ï¼Œåœ¨ `src/utils` æ–‡ä»¶å¤¹ä¸‹æ–°å»º `regexp.js` æ–‡ä»¶ï¼Œæˆ‘ä»¬æŠŠä¸€äº›å¸¸ç”¨æ­£åˆ™å†™è¿›å»ï¼Œå¦‚ä¸‹ï¼š

```jsx
export const isNumber = /^[0-9]*$/g
isNumber.name = 'åŒ¹é…æ•°å­—'

export const isNonnegativeInteger = /^\d+$/g
isNonnegativeInteger.name = 'åŒ¹é…éè´Ÿæ•´æ•°ï¼ˆæ­£æ•´æ•° + 0ï¼‰'

export const isPositiveInteger = /^[0-9]*[1-9][0-9]*$/g
isPositiveInteger.name = 'åŒ¹é…æ­£æ•´æ•°'

export const isNegativeInteger = /^-[0-9]*[1-9][0-9]*$/g
isNegativeInteger.name = 'åŒ¹é…è´Ÿæ•´æ•°'

export const isInteger = /^-?\d+$/g
isInteger.name = 'åŒ¹é…æ•´æ•°'

export const isNonpositiveInteger = /^((-\d+)|(0+))$/g
isNonpositiveInteger.name = 'åŒ¹é…éæ­£æ•´æ•°ï¼ˆè´Ÿæ•´æ•° + 0ï¼‰'

export const isNonnegativeFloat = /^\d+(\.\d+)?$/g
isNonnegativeFloat.name = 'åŒ¹é…éè´Ÿæµ®ç‚¹æ•°ï¼ˆæ­£æµ®ç‚¹æ•° + 0ï¼‰'

export const isPositiveFloat =
  /^((0\.\d*[1-9]\d*)|([1-9]\d*\.\d*)|([1-9]\d*))$/g
isPositiveFloat.name = 'åŒ¹é…æ­£æµ®ç‚¹æ•°'

export const isNegativeFloat =
  /^-((0\.\d*[1-9]\d*)|([1-9]\d*\.\d*)|([1-9]\d*))$/g
isNegativeFloat.name = 'åŒ¹é…è´Ÿæµ®ç‚¹æ•°'

export const isFloat = /^(-?\d+)(\.\d+)?$/g
isFloat.name = 'åŒ¹é…æµ®ç‚¹æ•°'

export const isNonpositiveFloat = /^((-\d+(\.\d+)?)|(0+(\.0+)?))$/g
isNonpositiveFloat.name = 'åŒ¹é…éæ­£æµ®ç‚¹æ•°ï¼ˆè´Ÿæµ®ç‚¹æ•° + 0ï¼‰'

export const isEnglish = /^[A-Za-z]+$/g
isEnglish.name = 'åŒ¹é…ç”±26ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²'

export const isLowercaseEnglish = /^[a-z]+$/g
isLowercaseEnglish.name = 'åŒ¹é…ç”±26ä¸ªè‹±æ–‡å­—æ¯çš„å°å†™ç»„æˆçš„å­—ç¬¦ä¸²'

export const isUppercaseEnglish = /^[A-Z]+$/g
isUppercaseEnglish.name = 'åŒ¹é…ç”±26ä¸ªè‹±æ–‡å­—æ¯çš„å¤§å†™ç»„æˆçš„å­—ç¬¦ä¸²'

export const isEnglishAndNumber = /^[A-Za-z0-9]+$/g
isEnglishAndNumber.name = 'åŒ¹é…ç”±æ•°å­—å’Œ26ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²'

export const isEnglishAndNumberAndUnderline = /^\w+$/g
isEnglishAndNumberAndUnderline.name =
  'åŒ¹é…ç”±æ•°å­—ã€26ä¸ªè‹±æ–‡å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²'

export const isChinese = /^[\u4e00-\u9fa5]{0,}$/g
isChinese.name = 'åŒ¹é…ä¸­æ–‡'

export const isPhone = /^1[3456789]\d{9}$/g
isPhone.name = 'åŒ¹é…æ‰‹æœºå·'

export const isIdCard = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/g
isIdCard.name = 'åŒ¹é…èº«ä»½è¯ï¼ˆä¸€ä»£&äºŒä»£ï¼‰'

export const isFirstGenerationIDCard = /(^\d{15}$)/g
isFirstGenerationIDCard.name = 'åŒ¹é…ä¸€ä»£èº«ä»½è¯'

export const isSecondGenerationIDCard = /(^\d{18}$)|(^\d{17}(\d|X|x)$)/g
isSecondGenerationIDCard.name = 'åŒ¹é…äºŒä»£èº«ä»½è¯'

export const isUrl = /^((https|http|ftp|rtsp|mms)?:\/\/)[^\s]+/g
isUrl.name = 'åŒ¹é…URL'

export const isIP = /^((25[0-5]|2[0-4]\d|[01]?\d\d?)($|(?!\.$)\.)){4}$/g
isIP.name = 'åŒ¹é…IP'

export const isDate = /^(\d{4})-(\d{2})-(\d{2})$/g
isDate.name = 'åŒ¹é…æ—¥æœŸ'

export const isTime = /^([01]\d|2[0-3])(:[0-5]\d){1,2}$/g
isTime.name = 'åŒ¹é…æ—¶é—´'

export const isDateTime =
  /^(\d{4})-(\d{2})-(\d{2})\s([01]\d|2[0-3])(:[0-5]\d){1,2}$/g
isDateTime.name = 'åŒ¹é…æ—¥æœŸæ—¶é—´'

export const isColor = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/g
isColor.name = 'åŒ¹é…é¢œè‰²'

export const isQQ = /^[1-9][0-9]{4,9}$/g
isQQ.name = 'åŒ¹é…QQ'

export const isWeChat = /^[a-zA-Z]([-_a-zA-Z0-9]{5,19})+$/g
isWeChat.name = 'åŒ¹é…å¾®ä¿¡'

export const isPostalCode = /[1-9]\d{5}(?!\d)/g
isPostalCode.name = 'åŒ¹é…é‚®ç¼–'

export const isMacAddress = /^([A-Fa-f0-9]{2}:){5}[A-Fa-f0-9]{2}$/g
isMacAddress.name = 'åŒ¹é…MACåœ°å€'

export const isIPV4 = /^((25[0-5]|2[0-4]\d|[01]?\d\d?)($|(?!\.$)\.)){4}$/g
isIPV4.name = 'åŒ¹é…IPV4åœ°å€'

export const isIPV6 = /^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/g
isIPV6.name = 'åŒ¹é…IPV6åœ°å€'

export const isBase64 = /[^A-Za-z0-9\+\/\=]/g
isBase64.name = 'åŒ¹é…Base64'

export const isPasswordStrong = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/g
isPasswordStrong.name = 'åŒ¹é…å¼ºå¯†ç '

export const isPasswordMedium = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{6,16}$/g
isPasswordMedium.name = 'åŒ¹é…ä¸­ç­‰å¯†ç '

export const isPasswordSimple = /^[a-zA-Z0-9_-]{6,16}$/g
isPasswordSimple.name = 'åŒ¹é…ç®€å•å¯†ç '

export const isCarNumber = /^[\u4e00-\u9fa5]{1}[A-Z]{1}[A-Z_0-9]{5}$/g
isCarNumber.name = 'åŒ¹é…è½¦ç‰Œå·ï¼ˆç®€å•ï¼‰'

export const isLicensePlateNumber =
  /^[äº¬æ´¥æ²ªæ¸å†€è±«äº‘è¾½é»‘æ¹˜çš–é²æ–°è‹æµ™èµ£é„‚æ¡‚ç”˜æ™‹è’™é™•å‰é—½è´µç²¤é’è—å·å®ç¼ä½¿é¢† A-Z]{1}[A-HJ-NP-Z]{1}[A-Z0-9]{4}[A-Z0-9æŒ‚å­¦è­¦æ¸¯æ¾³]{1}$/g
isLicensePlateNumber.name = 'åŒ¹é…è½¦ç‰Œå·ï¼ˆä¸¥æ ¼ï¼‰'

export const isStockCode =
  /^(s[hz]|S[HZ])(000[\d]{3}|002[\d]{3}|300[\d]{3}|600[\d]{3}|60[\d]{4})$/g
isStockCode.name = 'åŒ¹é…è‚¡ç¥¨ä»£ç '

export const isBankCard = /^([1-9]{1})(\d{14}|\d{18})$/g
isBankCard.name = 'åŒ¹é…é“¶è¡Œå¡'

export const is126Email = /((^([a-zA-Z]))(\w){5,17})@126.com$/g
is126Email.name = 'åŒ¹é…126é‚®ç®±'

export const is163Email = /((^([a-zA-Z]))(\w){5,17})@163.com$/g
is163Email.name = 'åŒ¹é…163é‚®ç®±'

export const isGmailEmail = /((^([a-zA-Z]))(\w){5,17})@gmail.com$/g
isGmailEmail.name = 'åŒ¹é…Gmailé‚®ç®±'

export const isQQEmail = /((^([a-zA-Z]))(\w){5,17})@qq.com$/g
isQQEmail.name = 'åŒ¹é…QQé‚®ç®±'

export const isSinaEmail = /((^([a-zA-Z]))(\w){5,17})@sina.com$/g
isSinaEmail.name = 'åŒ¹é…æ–°æµªé‚®ç®±'

export const isSohuEmail = /((^([a-zA-Z]))(\w){5,17})@sohu.com$/g
isSohuEmail.name = 'åŒ¹é…æœç‹é‚®ç®±'

export const isYahooEmail = /((^([a-zA-Z]))(\w){5,17})@yahoo.com$/g
isYahooEmail.name = 'åŒ¹é…é›…è™é‚®ç®±'

export const isOutlookEmail = /((^([a-zA-Z]))(\w){5,17})@outlook.com$/g
isOutlookEmail.name = 'åŒ¹é…Outlooké‚®ç®±'

export const isHotmailEmail = /((^([a-zA-Z]))(\w){5,17})@hotmail.com$/g
isHotmailEmail.name = 'åŒ¹é…Hotmailé‚®ç®±'

export const isEmail = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+$/g
isEmail.name = 'åŒ¹é…é‚®ç®±'
```

å¦‚ä¸Šï¼Œæˆ‘ä»¬å­—é¢é‡åˆ›å»ºå¹¶å¯¼å‡ºäº†å¾ˆå¤šæ­£åˆ™å¯¹è±¡ï¼Œè€Œä¸”ç»™æ¯ä¸ªæ­£åˆ™å¯¹è±¡éƒ½åŠ äº†åå­—ç•™ä½œåç”¨ï¼

**PSï¼š**ç½‘ä¸Šéšä¾¿æ‘˜æŠ„äº†äº›ï¼Œç®€å•çœ‹äº†ä¸‹ï¼Œæš‚æ—¶æ²¡æœ‰éªŒè¯å¯¹é”™ï¼Œä¸ä¿çœŸå“ˆï¼Œåé¢ç”¨ç€ä¸å¯¹å†æ”¹å§ï¼Œå¤§å®¶æœ‰ä»€ä¹ˆè¡¥å……çš„æˆ–è€…å‘ç°æœ‰é”™è¯¯ï¼Œå¯ä»¥ç›´æ¥å» `GitHub` æ `PR` æˆ–è€… `issues` å“ˆï¼Œå¯ä»¥ä¸€å—å®Œå–„ä¸‹ï¼Œæ–¹é¢å¤§å®¶å˜›ï¼ï¼

## æ­£åˆ™è¾“å…¥æ¡†

æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹å†™ä»£ç ï¼Œä¸Šé¢è¯´è¿‡æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªé¡µé¢åˆ†ä¸ºä¸Šä¸­ä¸‹ä¸‰å—ï¼Œå…ˆæ¥ç®€å•å†™ä¸ªå¸ƒå±€ï¼Œä¿®æ”¹ `RegularPage/index.vue` æ­£åˆ™æ ¡éªŒé¡µé¢ï¼Œå¦‚ä¸‹ï¼š

```html
<script setup></script>

<template>
  <div class="max-w-1200px w-full p-20px box-border">
		<!-- ä¸Š -->
    <div class="flex justify-start items-center"></div>
		<!-- ä¸­ -->
    <div class="mt-20px bg-[var(--color-fill-2)]"></div>
		<!-- ä¸‹ -->
    <div class="w-full mt-20px"></div>
  </div>
</template>
```

OKï¼Œæ•´æ´»å§ï¼æˆ‘ä»¬å…ˆçœ‹ä¸‹ä»£ç ï¼Œä¹Ÿå°±æ˜¯æ­£åˆ™è¾“å…¥æ¡†ç›¸å…³çš„ä»£ç ï¼Œä¿®æ”¹ `RegularPage/index.vue` æ­£åˆ™æ ¡éªŒé¡µé¢å¦‚ä¸‹ï¼š

```html
<script setup>
import * as regPresetsObj from '@/utils/regexp.js'

// å¤§å°
const size = ref('large')
// æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²
const regStr = ref('')
// æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦
const regFlag = ref([])
// æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
const reg = ref(null)
watchEffect(() => {
  try {
    reg.value = regStr.value
      ? new RegExp(regStr.value, regFlag.value.join(''))
      : null
  } catch (err) {
    reg.value = null
  }
})

// é¢„è®¾è‡ªåŠ¨æœç´¢
const auto = ref(true)
// æ­£åˆ™é¢„è®¾åˆ—è¡¨
const regPresets = ref([])
// æ­£åˆ™é¢„è®¾åŒ¹é…æ–¹æ³•
const regPresetMatch = value => {
  if (value && auto.value) {
    regPresets.value = [...Object.values(regPresetsObj)]
      .filter(r => r.name.includes(value) || r.source.includes(value))
      .map(v => {
        return {
          label: v.name,
          regexp: v,
          value: v.source
        }
      })
  } else {
    regPresets.value = []
  }
}
// æ­£åˆ™é¢„è®¾é€‰ä¸­æ–¹æ³•
const regPresetSelect = r => {
  let selected = regPresets.value.find(v => v.value === r)
  if (selected) regFlag.value = selected.regexp.flags.split('')
}
</script>
<template>
  <div class="max-w-1200px w-full p-20px box-border">
		<!-- ä¸Š -->
    <div class="flex justify-start items-center">
      <a-tooltip
        :content="`ç‚¹å‡»${auto ? 'å…³é—­' : 'å¼€å¯'}é¢„è®¾æ­£åˆ™è‡ªåŠ¨åŒ¹é…`"
        position="bottom"
      >
        <a-button :size="size" @click="auto = !auto">
          <template #icon>
            <icon-material-symbols-astrophotography-auto
              :class="auto ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
      </a-tooltip>

      <a-auto-complete
        class="ml-10px"
        v-model="regStr"
        :data="regPresets"
        @search="regPresetMatch"
        @select="regPresetSelect"
        :placeholder="`è¯·è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼${
          auto ? 'æˆ–è¾“å…¥æ–‡å­—é€‰æ‹©è‡ªåŠ¨åŒ¹é…çš„é¢„è®¾æ­£åˆ™' : ''
        }`"
        allow-clear
        :size="size"
      >
        <template #prepend>
          <a-tooltip
            :content="reg ? 'æ­£åˆ™è¡¨è¾¾å¼æ­£ç¡®' : 'æ­£åˆ™è¡¨è¾¾å¼æœ‰è¯¯'"
            position="bottom"
            mini
          >
            <icon-jam-triangle-danger-f
              class="text-[rgb(var(--orange-6))]"
              v-if="!reg"
            />
            <icon-mdi-hand-okay class="text-[rgb(var(--green-6))]" v-else />
          </a-tooltip>

          <span class="ml-5px">/</span>
        </template>
        <template #append>
          <span> /{{ reg?.flags || regFlag?.join('') }}</span>
        </template>
      </a-auto-complete>

      <a-popover title="é€‰æ‹©ä¿®é¥°ç¬¦" position="bl">
        <a-button :size="size" class="ml-10px">
          <template #icon>
            <icon-mdi-filter-multiple
              :class="regFlag.length > 0 ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
        <template #content>
          <div class="min-w-200px">
            <a-checkbox-group
              :size="size"
              v-model="regFlag"
              direction="vertical"
            >
              <a-checkbox value="g"> -gï¼šå…¨å±€åŒ¹é… </a-checkbox>
              <a-checkbox value="i"> -iï¼šå¿½ç•¥å¤§å°å†™</a-checkbox>
              <a-checkbox value="m"> -mï¼šå¤šè¡ŒåŒ¹é…</a-checkbox>
              <a-checkbox value="s"> -sï¼šç‰¹æ®Šå­—ç¬¦. åŒ…å«æ¢è¡Œç¬¦</a-checkbox>
            </a-checkbox-group>
          </div>
        </template>
      </a-popover>
    </div>
		
		<!-- ä¸­ -->
    <div class="mt-20px bg-[var(--color-fill-2)]"></div>
		
		<!-- ä¸‹ -->
    <div class="w-full mt-20px"></div>
  </div>
</template>
```

æ¥ç®€å•ä»‹ç»ä¸‹ä¸Šé¢ä»£ç å†…å®¹ï¼š

è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ `ArcoDesign` ç»„ä»¶ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå“åº”å¼å±æ€§ `size` ç”¨æ¥æ§åˆ¶é¡µé¢ä¸Šè¾“å…¥æ¡†ç­‰ `ArcoDesign` ç»„ä»¶å¤§å°ã€‚

åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸² `regStr`ï¼Œæ³¨æ„è¿™é‡Œçš„æ­£åˆ™å­—ç¬¦ä¸²æ˜¯ä¸å¸¦åŒæ–œæ  `//` çš„ã€‚

åˆ›å»ºæ­£åˆ™ä¿®é¥°ç¬¦ `regFlag`ï¼Œä¿®é¥°ç¬¦è¿™é‡Œæˆ‘ä»¬åˆ›å»ºçš„æ˜¯ä¸ªå“åº”å¼æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸€é¡¹ä»£è¡¨ä¸€ä¸ªæ­£åˆ™ä¿®é¥°ç¬¦ï¼ˆä¿®é¥°ç¬¦æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„æ ‡è®°ï¼Œç”¨äºæŒ‡å®šé¢å¤–çš„åŒ¹é…ç­–ç•¥ï¼Œä¸ç†è§£çš„åŒå­¦å¯ä»¥ç™¾åº¦è°·æ­Œä¸‹ï¼‰ã€‚

æ­£åˆ™å­—ç¬¦ä¸²å’Œä¿®é¥°ç¬¦æœ‰äº†ï¼Œé‚£æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿå°±æœ‰äº†ï¼Œåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ `reg`ï¼Œæˆ‘ä»¬é€šè¿‡ `Vue API` çš„ `watchEffect` æ–¹æ³•æ¥ç›‘å¬ `regStr` å’Œ `regFlag` æ”¹å˜ï¼Œéšä¹‹ç»™æ­£åˆ™å¯¹è±¡ `reg` èµ‹å€¼ï¼Œåˆ›å»ºçš„æ—¶å€™ä½¿ç”¨ `tryâ€¦catch` åŒ…è£¹ï¼Œè¿™æ ·å¦‚æœåˆ›å»ºå¤±è´¥ä¼šèµ° `catch`ï¼Œæˆ‘ä»¬åœ¨ `catch` ä¸­æŠŠæ­£åˆ™å¯¹è±¡æ¸…ç©ºï¼Œåˆ«é—®ä¸ºå•¥ä¸ç”¨è®¡ç®—å±æ€§ï¼Œå› ä¸ºæ­£åˆ™å¯¹è±¡ `reg` åé¢ç”¨çš„å¾ˆå¤šï¼Œä½¿ç”¨è®¡ç®—å±æ€§åé¢ä¼šå¾ˆéº»çƒ¦ã€‚

æ¥ç€è¿˜åˆ›å»ºäº†ä¸€ä¸ªæ˜¯å¦å¼€èµ·æ­£åˆ™é¢„è®¾æœç´¢çš„å±æ€§ `auto`ï¼Œé»˜è®¤ä¸º `true`ï¼Œä»£è¡¨å¯ä»¥è¾“å…¥ä¸­æ–‡æ¨¡ç³ŠåŒ¹é…é¢„è®¾çš„æ­£åˆ™ã€‚

OKï¼Œå†çœ‹æ¨¡æ¿ï¼Œ`Template` æ¨¡æ¿ä¸­æ¯ä¸ªåŠŸèƒ½æŒ‰é’®æˆ‘ä»¬éƒ½ä½¿ç”¨ `ArcoDesign` çš„ `a-tooltip` ç»„ä»¶åšäº†ä¸ªæ‚¬æµ®æ°”æ³¡æç¤ºï¼Œä¸‹æ–‡æ‰€æœ‰åŠŸèƒ½æŒ‰é’®éƒ½æœ‰æ°”æ³¡æç¤ºï¼Œä¸åœ¨èµ˜è¿°ã€‚

åœ¨ä¸Šä¸­ä¸‹ä¸‰ä¸ªæ¨¡å—çš„ä¸Šæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬å…ˆå†™äº†ä¸€ä¸ªé¢„è®¾åŒ¹é…å¼€å¯æŒ‰é’®ï¼Œé€šè¿‡ `auto` å±æ€§å€¼æ¸²æŸ“ä¸åŒå›¾æ ‡é¢œè‰²æ¥åŒºåˆ†æ˜¯å¦å¼€å¯é¢„è®¾åŒ¹é…ï¼Œå›¾æ ‡ä½¿ç”¨çš„æ˜¯ `iconify` å›¾æ ‡åº“çš„ `material-symbols:astrophotography-auto` å›¾æ ‡ï¼ˆè‡ªåŠ¨å¼•å…¥é…ç½®çœ‹å‰æ–‡ï¼Œåé¢ `iconify` å›¾æ ‡åº“çš„å›¾æ ‡æˆ‘å°±ä¸æäº†å“ˆï¼Œçœ‹ä¸‹å›¾æ ‡ç»„ä»¶åå°±çŸ¥é“æ˜¯å“ªä¸ªå›¾æ ‡äº†ï¼Œå¦‚æœæœ‰ç”¨åˆ°è‡ªå®šä¹‰çš„å›¾æ ‡æˆ‘å†å•ç‹¬è¯´ï¼‰ï¼Œå¹¶ä¸”ç»™è¯¥æŒ‰é’®å†™äº†ç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»ä¿®æ”¹ `auto` å±æ€§å€¼ï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```html
<a-tooltip
  :content="`ç‚¹å‡»${auto ? 'å…³é—­' : 'å¼€å¯'}é¢„è®¾æ­£åˆ™è‡ªåŠ¨åŒ¹é…`"
  position="bottom"
>
  <a-button :size="size" @click="auto = !auto">
    <template #icon>
      <icon-material-symbols-astrophotography-auto
        :class="auto ? 'text-[rgb(var(--arcoblue-6))]' : ''"
      />
    </template>
  </a-button>
</a-tooltip>
```

æ¥ç€æ˜¯è¾“å…¥æ¡†ï¼Œç”±äºè¾“å…¥æ¡†æœ‰é¢„è®¾åŒ¹é…çš„éœ€æ±‚ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `ArcoDesign` çš„ `a-auto-complete` ç»„ä»¶ï¼Œç»„ä»¶ `v-model` å€¼å³ä¸Šé¢åˆ›å»ºçš„æ­£åˆ™å­—ç¬¦ä¸²å±æ€§ `regStr`ã€‚

åœ¨å¼€å¤´æˆ‘ä»¬å¯¼å…¥äº† `regexp.js` æ–‡ä»¶ä¸­å…¨éƒ¨çš„æ­£åˆ™é¢„è®¾å¯¹è±¡ `regPresetsObj` ã€‚

`a-auto-complete` ç»„ä»¶çš„ `data` å±æ€§å³ä¸‹æ‹‰åˆ—è¡¨æ•°æ®ï¼Œæˆ‘ä»¬å¡«å…¥é¢„è®¾æ•°ç»„ `regPresets`ï¼Œé»˜è®¤æ˜¯ç©ºçš„æ•°ç»„å³æ²¡æœ‰åŒ¹é…ä¸­é¡¹ã€‚ç»„ä»¶çš„ `search` æ–¹æ³•å³è‡ªå®šä¹‰çš„åŒ¹é…æ–¹æ³•ï¼Œæˆ‘ä»¬å†™äº† `regPresetMatch` æ–¹æ³•å»åŒ¹é…ã€‚`regPresetMatch` æ–¹æ³•ä¸­å‚æ•° `value` å³æ­£åˆ™å­—ç¬¦ä¸² `regStr` å€¼ï¼Œæˆ‘ä»¬åœ¨æ–¹æ³•ä¸­æ ¡éªŒ `value` å€¼å­˜åœ¨å¹¶ä¸”é¢„è®¾åŒ¹é… `auto` å±æ€§ä¸º `true` çš„æƒ…å†µä¸‹å»åŒ¹é…é»˜è®¤é¢„è®¾åˆ—è¡¨ `regPresetsObj` ä¸­çš„æ•°æ®åŒ¹é…å¹¶è¿”å›ä¸€ä¸ªåŒ¹é…åˆ°çš„åˆ—è¡¨èµ‹å€¼ç»™é¢„è®¾æ•°ç»„ `regPresets`ï¼Œå¦‚æœ `value` å€¼ä¸ºç©ºæˆ–è€… `auto` å±æ€§ä¸º `false` åˆ™é‡ç½®é¢„è®¾æ•°ç»„ `regPresets` ã€‚è¿™æ ·æˆ‘ä»¬æ¯æ¬¡å†™å†…å®¹æ—¶é¢„è®¾åˆ—è¡¨ä¸­æœ‰åŒ¹é…åˆ°å°±ä¼šä»¥ä¸‹æ‹‰çš„å½¢å¼å±•ç¤ºå‡ºæ¥ã€‚

**PSï¼š**æ¨¡ç³ŠåŒ¹é…ä¸»è¦æ˜¯ç”¨ `ES6` çš„ `includes`ã€`filter` æ–¹æ³•ï¼Œæ–°åŒå­¦å¯ä»¥æŸ¥æŸ¥æ–‡æ¡£ã€‚

é¢„è®¾æ•°ç»„ `regPresets`  çš„æ ¼å¼æ˜¯æ ¹æ®ç»„ä»¶è¦æ±‚æ¥çš„ï¼Œå³æ•°ç»„å¯¹è±¡ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡å±æ€§å¦‚ä¸‹ï¼š

- `label` é¢„è®¾æ­£åˆ™é¡¹ä¸­æ–‡åã€‚
- `value` é¢„è®¾æ­£åˆ™é¡¹ `key` ï¼Œæˆ‘ä»¬ä½¿ç”¨æ­£åˆ™å¯¹è±¡çš„ `source` å€¼æ¥ä½œä¸º `key` ï¼Œæ­£åˆ™å¯¹è±¡çš„ `source` å±æ€§å³æ­£åˆ™å­—ç¬¦ä¸²ï¼ˆä¸å¸¦åŒæ–œæ ä¸å¸¦ä¿®é¥°ç¬¦çš„é‚£ç§ï¼‰ã€‚
- `regexp` é¢„è®¾æ­£åˆ™å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å±æ€§ï¼Œç”¨æ¥åé¢ä¸‹æ‹‰é€‰ä¸­æ—¶ç»™ä¿®é¥°ç¬¦èµ‹å€¼ã€‚

ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```jsx
// æ­£åˆ™é¢„è®¾åŒ¹é…æ–¹æ³•
const regPresetMatch = value => {
  if (value && auto.value) {
    regPresets.value = [...Object.values(regPresetsObj)]
      .filter(r => r.name.includes(value) || r.source.includes(value))
      .map(v => {
        return {
          label: v.name,
          regexp: v,
          value: v.source
        }
      })
  } else {
    regPresets.value = []
  }
}
```

é»˜è®¤ `a-auto-complete` ç»„ä»¶é€‰ä¸­æ—¶ä¼šå°†ä¸‹æ‹‰åˆ—è¡¨é€‰ä¸­é¡¹çš„ `value` å€¼èµ‹å€¼ç»™ç»„ä»¶ `v-model` å±æ€§ï¼ŒåŒ¹é…é¡¹çš„ `value` å€¼æˆ‘ä»¬ä¹‹å‰è®¾ç½®çš„æ˜¯æ­£åˆ™å­—ç¬¦ä¸²ï¼Œå³åŒ¹é…åˆ°é¢„è®¾é€‰ä¸­å `value` å€¼å°±ä¼šèµ‹å€¼ç»™ `regStr` å±æ€§ï¼Œç”±äºæˆ‘ä»¬çš„é¢„è®¾æ­£åˆ™ä¸­å¯èƒ½æºå¸¦ä¿®é¥°ç¬¦ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨ç»„ä»¶ `select` é€‰ä¸­äº‹ä»¶ä¸­ç»™ä¿®é¥°ç¬¦ `regFlag` å±æ€§èµ‹å€¼ï¼Œå³ `regPresetSelect` æ–¹æ³•å†…å®¹ï¼Œå¦‚ä¸‹ï¼š

```jsx
// æ­£åˆ™é¢„è®¾é€‰ä¸­æ–¹æ³•
const regPresetSelect = r => {
  let selected = regPresets.value.find(v => v.value === r)
  if (selected) regFlag.value = selected.regexp.flags.split('')
}
```

**PSï¼š** æ­£åˆ™å¯¹è±¡ä¸­çš„ `source` å±æ€§æ˜¯æ­£åˆ™å­—ç¬¦ä¸²ï¼Œè€Œ `flags` å±æ€§ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå³è¯¥æ­£åˆ™çš„ä¿®é¥°ç¬¦ï¼Œä¸æ™“å¾—çš„åŒå­¦å¯ä»¥æ§åˆ¶å°éšä¾¿æ‰“å°ä¸€ä¸ªæ­£åˆ™å¯¹è±¡çœ‹ä¸‹ã€‚

OKï¼Œæˆ‘ä»¬åœ¨ `a-auto-complete` ç»„ä»¶ä¸­è¿˜å†™äº†ä¸¤ä¸ªæ’æ§½ï¼ŒåŒæ ·éƒ½æ˜¯ç»„ä»¶æ’æ§½å“ˆï¼Œå¯ä»¥çœ‹çœ‹æ–‡æ¡£ï¼Œå‰ç½®æ’æ§½ `prepend` å’Œåç½®æ’æ§½ `append`ï¼Œå‰ç½®æ’æ§½ä¸­é™¤äº† `/` ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ç®€å•ç”¨ `2` ä¸ªå›¾æ ‡æ¥æç¤ºå½“å‰è¾“å…¥æ­£åˆ™çš„å¯¹é”™ï¼Œåç½®æ’æ§½ä¸­é™¤äº† `/` ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æ¸²æŸ“äº†å½“å‰é€‰ä¸­çš„ä¿®é¥°ç¬¦ `regFlag`ã€‚

ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```html
<a-auto-complete
  class="ml-10px"
  v-model="regStr"
  :data="regPresets"
  @search="regPresetMatch"
  @select="regPresetSelect"
  :placeholder="`è¯·è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼${
    auto ? 'æˆ–è¾“å…¥æ–‡å­—é€‰æ‹©è‡ªåŠ¨åŒ¹é…çš„é¢„è®¾æ­£åˆ™' : ''
  }`"
  allow-clear
  :size="size"
>
  <template #prepend>
    <a-tooltip
      :content="reg ? 'æ­£åˆ™è¡¨è¾¾å¼æ­£ç¡®' : 'æ­£åˆ™è¡¨è¾¾å¼æœ‰è¯¯'"
      position="bottom"
      mini
    >
      <icon-jam-triangle-danger-f
        class="text-[rgb(var(--orange-6))]"
        v-if="!reg"
      />
      <icon-mdi-hand-okay class="text-[rgb(var(--green-6))]" v-else />
    </a-tooltip>

    <span class="ml-5px">/</span>
  </template>
  <template #append>
    <span> /{{ reg?.flags || regFlag?.join('') }}</span>
  </template>
</a-auto-complete>
```

OKï¼Œæœ€åå°±æ˜¯ä¿®é¥°ç¬¦é€‰é¡¹äº†ï¼Œä½¿ç”¨åŒä¸€ä¸ªå›¾æ ‡æŒ‰é’®ï¼Œä»¥ä¸åŒé¢œè‰²åŒºåˆ†æ˜¯å¦é€‰ä¸­æœ‰ä¿®é¥°ç¬¦ï¼Œä½¿ç”¨ `ArcoDesign` çš„ `a-popover` ç»„ä»¶ä½¿é¼ æ ‡æ‚¬æµ®åˆ°å›¾æ ‡æŒ‰é’®æ—¶å‡ºç°æ°”æ³¡æç¤ºå¼¹çª—ï¼Œå¼¹çª—å†…ä»¥å¤šé€‰æ¡†ç»„ `a-checkbox-group` ç»„ä»¶æ¸²æŸ“å‡ ä¸ªä¿®é¥°ç¬¦é€‰é¡¹ï¼Œ`v-model` å€¼è®¾ç½®ä¸ºä¿®é¥°ç¬¦å±æ€§ `regFlag` ï¼ˆæ•°ç»„ï¼‰å³å¯ã€‚

ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```html
<a-popover title="é€‰æ‹©ä¿®é¥°ç¬¦" position="bl">
  <a-button :size="size" class="ml-10px">
    <template #icon>
      <icon-mdi-filter-multiple
        :class="regFlag.length > 0 ? 'text-[rgb(var(--arcoblue-6))]' : ''"
      />
    </template>
  </a-button>
  <template #content>
    <div class="min-w-200px">
      <a-checkbox-group
        :size="size"
        v-model="regFlag"
        direction="vertical"
      >
        <a-checkbox value="g"> -gï¼šå…¨å±€åŒ¹é… </a-checkbox>
        <a-checkbox value="i"> -iï¼šå¿½ç•¥å¤§å°å†™</a-checkbox>
        <a-checkbox value="m"> -mï¼šå¤šè¡ŒåŒ¹é…</a-checkbox>
        <a-checkbox value="s"> -sï¼šç‰¹æ®Šå­—ç¬¦. åŒ…å«æ¢è¡Œç¬¦</a-checkbox>
      </a-checkbox-group>
    </div>
  </template>
</a-popover>
```

ä¿®é¥°ç¬¦æˆ‘ä»¬å†™äº†å››ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š

- `-g` åŒ¹é…å…¨å±€ã€‚
- `-i` å¿½ç•¥å¤§å°å†™ã€‚
- `-m` åŒ¹é…å¤šè¡Œã€‚
- `-s` ç‰¹æ®Šå­—ç¬¦.ï¼ŒåŒ…å«æ¢è¡Œç¬¦ã€‚

OKï¼Œç®€å•è§£é‡Šäº†ä¸€ä¸‹ä¸Šé¢ä»£ç çš„æ„æ€ï¼Œä¿å­˜åˆ·æ–°é¡µé¢ï¼Œå½“å‰æ•ˆæœå¦‚ä¸‹ï¼š

![http://qiniuimages.isboyjc.com/picgo/202211280239780.png](http://qiniuimages.isboyjc.com/picgo/202211280239780.png)

![http://qiniuimages.isboyjc.com/picgo/202211290214707.png](http://qiniuimages.isboyjc.com/picgo/202211290214707.png)

æ­£åˆ™å¯¹è±¡æœ‰äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å†™åŒ¹é…ç»“æœï¼

## æ­£åˆ™åŒ¹é…ç»“æœé¢„è§ˆ

æƒ³è¦åŒ¹é…ç»“æœæˆ‘ä»¬è¦å…ˆå£°æ˜ä¸€ä¸ªå¾…åŒ¹é…çš„å­—ç¬¦ä¸²å±æ€§ `matchStr`ï¼Œç„¶åä½¿ç”¨ `ArcoDesign` çš„ `a-textarea` ç»„ä»¶å†™ä¸ªå¤šè¡Œæ–‡æœ¬å³å¯ï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```html
<script setup>
// å¾…åŒ¹é…å­—ç¬¦ä¸²
const matchStr = ref('')
</script>

<a-textarea
  v-model="matchStr"
  default-value=""
  placeholder="è¯·è¾“å…¥è¦åŒ¹é…çš„å­—ç¬¦ä¸²"
  :auto-size="{
    minRows: 3,
    maxRows: 6
  }"
/>
```

æ¥ç€æˆ‘ä»¬éœ€è¦å±•ç¤ºå½“å‰å¾…åŒ¹é…å­—ç¬¦ä¸²åŸºäºæ­£åˆ™å¯¹è±¡åŒ¹é…åˆ°çš„å†…å®¹ï¼Œè¿™é‡Œç›´æ¥ç”¨è®¡ç®—å±æ€§æ¥ç›‘å¬å¾…åŒ¹é…å­—ç¬¦ä¸²æ”¹å˜ç„¶åä½¿ç”¨ `match` æ–¹æ³•åœ¨å¾…åŒ¹é…å­—ç¬¦ä¸²ä¸­åŒ¹é…æ­£åˆ™å¯¹åº”å€¼å³å¯ã€‚

**PSï¼š** `match` æ–¹æ³•å¯åœ¨å­—ç¬¦ä¸²å†…æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œæˆ–æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…ï¼Œä¸äº†è§£çš„åŒå­¦è¿˜æ˜¯æŸ¥ä¸‹æ–‡æ¡£ã€‚

å¦‚ä¸‹ï¼š

```jsx
// åŒ¹é…ç»“æœæ•°ç»„ regå³ä¸Šæ–‡å†™çš„æ­£åˆ™å¯¹è±¡ filterè¿‡æ»¤ç©ºå€¼ï¼Œé»˜è®¤ç©ºæ•°ç»„
const matchingResults = computed(
  () => matchStr.value.match(reg.value)?.filter(v => v) || []
)
```

OKï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨ `Template` æ¨¡æ¿ä¸­ç®€å•å†™ä¸€ä¸‹åŒ¹é…ç»“æœçš„ `HTML` äº†ï¼Œæ ¡éªŒå½“åŒ¹é…åˆ°çš„ç»“æœæ•°ç»„ `matchingResults` é•¿åº¦å¤§äº `0`ï¼Œå³å±•ç¤ºä¸€å…±å¤šå°‘é¡¹åŒ¹é…ï¼Œç„¶åä¾æ¬¡åˆ—å‡ºåŒ¹é…çš„ç»“æœå€¼ã€‚æ•°ç»„é•¿åº¦å°äºç­‰äº `0` åˆ™ä¸å±•ç¤ºã€‚

```jsx
<div
  v-if="matchingResults.length > 0"
  class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
>
  <div>å…± {{ matchingResults.length }} å¤„åŒ¹é…ï¼š</div>
  <div v-for="(res, i) of matchingResults" :key="i">{{ res }}</div>
</div>
```

ä¸Šé¢æˆ‘ä»¬åªå±•ç¤ºäº†åŒ¹é…åˆ°çš„å„ä¸ªç»“æœï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨å®Œæ•´å¾…åŒ¹é…å­—ç¬¦ä¸²ä¸­å±•ç¤ºä¸€ä¸‹å„ä¸ªåŒ¹é…ç»“æœçš„ä½ç½®ï¼Œå³å±•ç¤ºå®Œæ•´å­—ç¬¦ä¸²ï¼Œå¹¶æŠŠåŒ¹é…ç»“æœä»¥ä¸åŒçš„é¢œè‰²åœ¨åŸå­—ç¬¦ä¸²ä¸­æ ‡è¯†å‡ºæ¥ã€‚

æƒ³ä¸€æƒ³ï¼ŒåŸå§‹å­—ç¬¦ä¸²æˆ‘ä»¬æœ‰ï¼ŒåŒ¹é…åˆ°çš„ç»“æœæˆ‘ä»¬ä¹Ÿæœ‰ï¼Œæ‰€ä»¥åŸºäºåŸå§‹å­—ç¬¦ä¸²å’ŒåŒ¹é…ç»“æœæˆ‘ä»¬å†™ä¸ªæ ¼å¼åŒ–æ–¹æ³•ç»™åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²åŠ ä¸€ä¸‹æ ‡ç­¾å’Œæ ·å¼ç„¶åè¿”å›æ¸²æŸ“åˆ°é¡µé¢å°±è¡Œäº†ï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```html
<script>
// å¾…åŒ¹é…å­—ç¬¦ä¸²
const matchStr = ref('')
// åŒ¹é…ç»“æœæ•°ç»„ regå³ä¸Šæ–‡å†™çš„æ­£åˆ™å¯¹è±¡ filterè¿‡æ»¤ç©ºå€¼ï¼Œé»˜è®¤ç©ºæ•°ç»„
const matchingResults = computed(
  () => matchStr.value.match(reg.value)?.filter(v => v) || []
)
// åŒ¹é…ç»“æœæ ¼å¼åŒ–
const matchingFormat = computed(() => {
  let res = '',
    str = matchStr.value
  let n = 1
  matchingResults.value.forEach(v => {
    if (n > 4) n = 1
    let matchStr = str.substr(0, v.length + str.indexOf(v))
    str = str.substr(v.length + str.indexOf(v))
    res += matchStr.replace(
      v,
      `<span class="matching matching${n}">${v}</span>`
    )
    n++
  })

  return res + str
})
</script>

<div
  class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
  v-html="matchingFormat || 'æ— åŒ¹é…ç»“æœ'"
></div>

<style>
.matching {
  @apply px-0px rounded-4px box-border;
}
.matching1 {
  @apply bg-[rgb(var(--arcoblue-2))];
}
.matching2 {
  @apply bg-[rgb(var(--green-2))];
}
.matching3 {
  @apply bg-[rgb(var(--orange-2))];
}
.matching4 {
  @apply bg-[rgb(var(--red-2))];
}
</style>
```

OKï¼ŒæŠŠä¸Šé¢è¿™äº›å†…å®¹ç»„åˆä¸€ä¸‹ï¼Œæ”¾åˆ° `RegularPage` é¡µé¢ä¸­ï¼Œç›®å‰æ­£åˆ™æ ¡éªŒé¡µé¢çš„ä»£ç å¦‚ä¸‹ï¼š

```html
<script setup>
import * as regPresetsObj from '@/utils/regexp.js'

// å¤§å°
const size = ref('large')
// æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
const reg = ref(null)
// æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²
const regStr = ref('')
// æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦
const regFlag = ref([])
watchEffect(() => {
  try {
    reg.value = regStr.value
      ? new RegExp(regStr.value, regFlag.value.join(''))
      : null
  } catch (err) {
    reg.value = null
  }
})

// é¢„è®¾è‡ªåŠ¨æœç´¢
const auto = ref(true)
// æ­£åˆ™é¢„è®¾åˆ—è¡¨
const regPresets = ref([])
// æ­£åˆ™é¢„è®¾åŒ¹é…æ–¹æ³•
const regPresetMatch = value => {
  if (value && auto.value) {
    regPresets.value = [...Object.values(regPresetsObj)]
      .filter(r => r.name.includes(value) || r.source.includes(value))
      .map(v => {
        return {
          label: v.name,
          regexp: v,
          value: v.source
        }
      })
  } else {
    regPresets.value = []
  }
}
// æ­£åˆ™é¢„è®¾é€‰ä¸­æ–¹æ³•
const regPresetSelect = r => {
  let selected = regPresets.value.find(v => v.value === r)
  if (selected) regFlag.value = selected.regexp.flags.split('')
}

// å¾…åŒ¹é…å­—ç¬¦ä¸²
const matchStr = ref('')
// åŒ¹é…ç»“æœ
const matchingResults = computed(
  () => matchStr.value.match(reg.value)?.filter(v => v) || []
)
// åŒ¹é…ç»“æœæ ¼å¼åŒ–
const matchingFormat = computed(() => {
  let res = '',
    str = matchStr.value
  let n = 1
  matchingResults.value.forEach(v => {
    if (n > 4) n = 1
    let matchStr = str.substr(0, v.length + str.indexOf(v))
    str = str.substr(v.length + str.indexOf(v))
    res += matchStr.replace(
      v,
      `<span class="matching matching${n}">${v}</span>`
    )
    n++
  })

  return res + str
})
</script>
<template>
  <div class="max-w-1200px w-full p-20px box-border">
    <div class="flex justify-start items-center">
      <a-tooltip
        :content="`ç‚¹å‡»${auto ? 'å…³é—­' : 'å¼€å¯'}é¢„è®¾æ­£åˆ™è‡ªåŠ¨åŒ¹é…`"
        position="bottom"
      >
        <a-button :size="size" @click="auto = !auto">
          <template #icon>
            <icon-material-symbols-astrophotography-auto
              :class="auto ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
      </a-tooltip>

      <a-auto-complete
        class="ml-10px"
        v-model="regStr"
        :data="regPresets"
        @search="regPresetMatch"
        @select="regPresetSelect"
        :placeholder="`è¯·è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼${
          auto ? 'æˆ–è¾“å…¥æ–‡å­—é€‰æ‹©è‡ªåŠ¨åŒ¹é…çš„é¢„è®¾æ­£åˆ™' : ''
        }`"
        allow-clear
        :size="size"
      >
        <template #prepend>
          <a-tooltip
            :content="reg ? 'æ­£åˆ™è¡¨è¾¾å¼æ­£ç¡®' : 'æ­£åˆ™è¡¨è¾¾å¼æœ‰è¯¯'"
            position="bottom"
            mini
          >
            <icon-jam-triangle-danger-f
              class="text-[rgb(var(--orange-6))]"
              v-if="!reg"
            />
            <icon-mdi-hand-okay class="text-[rgb(var(--green-6))]" v-else />
          </a-tooltip>

          <span class="ml-5px">/</span>
        </template>
        <template #append>
          <span> /{{ reg?.flags || regFlag?.join('') }}</span>
        </template>
      </a-auto-complete>

      <a-popover title="é€‰æ‹©ä¿®é¥°ç¬¦" position="bl">
        <a-button :size="size" class="ml-10px">
          <template #icon>
            <icon-mdi-filter-multiple
              :class="regFlag.length > 0 ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
        <template #content>
          <div class="min-w-200px">
            <a-checkbox-group
              :size="size"
              v-model="regFlag"
              direction="vertical"
            >
              <a-checkbox value="g"> -gï¼šå…¨å±€åŒ¹é… </a-checkbox>
              <a-checkbox value="i"> -iï¼šå¿½ç•¥å¤§å°å†™</a-checkbox>
              <a-checkbox value="m"> -mï¼šå¤šè¡ŒåŒ¹é…</a-checkbox>
              <a-checkbox value="s"> -sï¼šç‰¹æ®Šå­—ç¬¦. åŒ…å«æ¢è¡Œç¬¦</a-checkbox>
            </a-checkbox-group>
          </div>
        </template>
      </a-popover>
    </div>

		<!-- ä¸­ -->
    <div class="mt-20px bg-[var(--color-fill-2)]"></div>

		<!-- ä¸‹ -->
    <div class="w-full mt-20px">
      <a-textarea
        v-model="matchStr"
        default-value=""
        placeholder="è¯·è¾“å…¥è¦åŒ¹é…çš„å­—ç¬¦ä¸²"
        :auto-size="{
          minRows: 3,
          maxRows: 6
        }"
      />

      <div
        class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
        v-html="matchingFormat || 'æ— åŒ¹é…ç»“æœ'"
      ></div>

      <div
        v-if="matchingResults.length > 0"
        class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
      >
        <div>å…± {{ matchingResults.length }} å¤„åŒ¹é…ï¼š</div>
        <div v-for="(res, i) of matchingResults" :key="i">{{ res }}</div>
      </div>
    </div>
  </div>
</template>

<style>
.matching {
  @apply px-0px rounded-4px box-border;
}
.matching1 {
  @apply bg-[rgb(var(--arcoblue-2))];
}
.matching2 {
  @apply bg-[rgb(var(--green-2))];
}
.matching3 {
  @apply bg-[rgb(var(--orange-2))];
}
.matching4 {
  @apply bg-[rgb(var(--red-2))];
}
</style>
```

ä¿å­˜åˆ·æ–°é¡µé¢ï¼Œè¾“å…¥ä¸€ä¸ªæ‰‹æœºå·æ­£åˆ™ï¼Œé€‰ä¸­ä¿®é¥°ç¬¦ `m` å³å¤šè¡ŒåŒ¹é…ï¼Œåœ¨å¾…åŒ¹é…è¾“å…¥æ¡†ä¸­è¾“å…¥ä¸€äº›æ­£ç¡®æˆ–è€…é”™è¯¯çš„æ‰‹æœºå·ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š

![http://qiniuimages.isboyjc.com/picgo/202211290305045.png](http://qiniuimages.isboyjc.com/picgo/202211290305045.png)

## æ­£åˆ™å¯è§†åŒ–é¢„è§ˆ

æ¥ä¸‹æ¥å†™ä¸‹æ­£åˆ™å¯¹è±¡çš„å¯è§†åŒ–å›¾è¡¨é¢„è§ˆï¼Œé¦–å…ˆæˆ‘ä»¬è¦å†™ä¸€ä¸ªæŒ‰é’®æ¥æ§åˆ¶æ˜¯å¦å¼€å¯å¯è§†åŒ–é¢„è§ˆï¼Œå£°æ˜ä¸€ä¸ªæ˜¯å¦å¼€å¯å¯è§†åŒ–é¢„è§ˆå±æ€§ `visualization` ï¼ˆé»˜è®¤ä¸º `true` å¼€å¯å³å¯ï¼‰ï¼Œç„¶åå’Œä¸Šé¢å¼€å¯é¢„è®¾ä¸€æ ·ï¼Œå†™ä¸€ä¸‹æŒ‰é’®ï¼ˆæŒ‰é’®å›¾æ ‡è¿˜æ˜¯ `iconify` å›¾æ ‡åº“ä¸­éšä¾¿æ‰¾çš„å›¾æ ‡å“ˆï¼Œçœ‹ä»£ç å°±è¡Œï¼‰æ”¾åœ¨ç¬¬ä¸€è¡Œä¿®é¥°ç¬¦æŒ‰é’®å³è¾¹å³å¯ï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```html
<script setup>
// å¯è§†åŒ–
const visualization = ref(true)
</script>

<a-tooltip
  :content="`ç‚¹å‡»${visualization ? 'å…³é—­' : 'å¼€å¯'}å¯è§†åŒ–è§£æ`"
  position="bottom"
>
  <a-button
    :size="size"
    class="ml-10px"
    @click="visualization = !visualization"
  >
    <template #icon>
      <icon-ic-sharp-visibility
        class="text-[rgb(var(--arcoblue-6))]"
        v-if="visualization"
      />
      <icon-ic-sharp-visibility-off v-else />
    </template>
  </a-button>
</a-tooltip>
```

æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹å†™å¯è§†åŒ–ç»„ä»¶äº†ï¼Œç®€å•æè¿°æµç¨‹å°±æ˜¯å…ˆç»™æ­£åˆ™å­—ç¬¦ä¸²åš `AST` è§£æï¼Œç„¶ååˆ†ææ­£åˆ™çš„ `AST` æ•°æ®ï¼Œæœ€åæ¸²æŸ“å›¾è¡¨ã€‚

è¯´èµ·æ¥å¾ˆç®€å•ï¼Œä½†æ˜¯çœŸå†™çš„è¯è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œè¿™é‡Œå°±ç›´æ¥ç”¨ä¸‰æ–¹åŒ…äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨ [regulex](https://github.com/CJex/regulex) æ¥åšè¿™ä»¶äº‹ã€‚

`regulex` æ˜¯ä¸€ä¸ª `JavaScript` æ­£åˆ™è¡¨è¾¾å¼è§£æå™¨å’Œå¯è§†åŒ–å·¥å…·ï¼Œè¿™ä¸ªåŒ…ä¹Ÿæ¯”è¾ƒè€äº†ï¼Œå¥½å‡ å¹´æ²¡æ›´æ–°äº†ï¼Œç”±äºæˆ‘ä»¬é¡¹ç›®æœ‰é»‘ç™½æ¨¡å¼åˆ‡æ¢ï¼Œä½†æ˜¯è¿™ä¸ªåŒ…æ˜¯ä¸æ”¯æŒä¿®æ”¹é¢œè‰²çš„ï¼Œäºæ˜¯æˆ‘ `clone` äº†ä¸‹æ¥ä»£ç ä¿®æ”¹äº†æ¸²æŸ“æ–¹æ³•ï¼Œè®©å®ƒæ”¯æŒäº†ä¸‹é»‘ç™½æ¨¡å¼ã€‚åœ¨å…‹éš†çš„æ—¶å€™ç”±äºä¸»åˆ†æ”¯ä»£ç æœ‰ç‚¹é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨çš„æ˜¯ `legacy` åˆ†æ”¯ä»£ç åšçš„ä¿®æ”¹ï¼Œç”±äº `legacy` åˆ†æ”¯ä»£ç æ„å»ºæ—¶ä½¿ç”¨çš„æ˜¯ `require.js` è¾“å‡ºçš„ `AMD` è§„èŒƒä»£ç ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚å…ˆå‡‘æ´»ç”¨å§ï¼Œå› ä¸ºå®ƒå¾ˆä¹…ä¸æ›´æ–°äº†ï¼Œåé¢æœ‰æ—¶é—´æˆ‘ä»¬åŸºäºè¿™ä¸ªåº“ï¼Œåªä½¿ç”¨å®ƒçš„æ­£åˆ™ `AST` è§£æä»¥åŠè§„åˆ™åˆ†æä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œç„¶åè‡ªå·±å†å†™ä¸€ä¸ªæ¸²æŸ“æ–¹æ³•æ„å»ºå‘ä¸ª `ESModule` åŒ…ï¼Œåˆ°æ—¶å€™æˆ‘è¡¥å……ä¸€ç¯‡æ–‡ç« ï¼Œç›®å‰è¿™ä¸ªåŒ…æ²¡å•¥å¯è¯´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€ä¼šå„¿åªä»‹ç»ä¸‹æ ¸å¿ƒæ–¹æ³•èƒ½ä½¿ç”¨å°±è¡Œäº†ï¼Œå› ä¸ºå®åœ¨æ˜¯å¤ªè€æ—§äº†ã€‚ã€‚ã€‚

**PSï¼š** `AMD`ã€`ESModule` ä»¥åŠ `require.js` ä¸äº†è§£å¯ä»¥çœ‹çœ‹å¦ä¸€ç¯‡æ–‡ç«  [ã€Œå‰ç«¯å·¥ç¨‹å››éƒ¨æ›²ã€æ¨¡å—åŒ–çš„å‰ä¸–ä»Šç”Ÿï¼ˆä¸Šï¼‰](https://juejin.cn/post/7007946894605287432)

åé¢å¯è§†åŒ–ç»„ä»¶ä»£ç ä¸­æˆ‘ä»¬ä¼šä½¿ç”¨åˆ° `regulex` åº“çš„ä¸‰ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š

- `parse()` - åšæ­£åˆ™ `AST` è§„åˆ™è§£æï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ­£åˆ™å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªè§£æåçš„æ•°æ®å¯¹è±¡ã€‚
- `Raphael()` - è¿™æ–¹æ³•æ¥æºäº [RaphaelJS](http://dmitrybaranovskiy.github.io/raphael/) ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº `SVG` çš„ç»˜å›¾åº“ï¼Œæ‰€ä»¥å®ƒæ˜¯ `regulex` ä¾èµ–çš„ä¸‰æ–¹åŒ…ï¼Œä¸»è¦å°±æ˜¯ç”¨æ¥ç»˜åˆ¶æ­£åˆ™å¯¹è±¡çš„ `SVG` å›¾è¡¨çš„ï¼Œå®ƒçš„ç”¨æ³•å¤§å®¶æƒ³è¦è¯¦ç»†äº†è§£çœ‹æ–‡æ¡£å§ã€‚ã€‚ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª `Raphael` å®ä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿå°±åªéœ€è¦åˆ›å»ºä¸ªå®ä¾‹å°±è¡Œäº†ã€‚
- `visualize()` - æœ‰äº† `AST` å’Œç»˜å›¾å®ä¾‹ï¼Œé‚£æ ¸å¿ƒçš„æ¸²æŸ“é€»è¾‘å°±æ˜¯è¿™ä¸ªæ–¹æ³•äº†ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯åŸºäºè§£æåçš„æ­£åˆ™å¯¹è±¡è§„åˆ™ä½¿ç”¨ `Raphael` å®ä¾‹æ¥ç»˜åˆ¶å›¾å½¢ã€‚æˆ‘è¿™è¾¹æ”¹çš„ä¹Ÿæ˜¯åªæ”¹äº†è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä½™éƒ½æ²¡åŠ¨ï¼Œè€Œä¸”ä¹Ÿä¸å½±å“åŸæ¥çš„ä»£ç é€»è¾‘ï¼Œæ­¤æ–¹æ³•æœ¬æ¥æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯è§£æåçš„æ­£åˆ™æ•°æ®å¯¹è±¡ï¼ˆå³ `parse()` æ–¹æ³•è¿”å›å€¼ï¼‰ã€æ­£åˆ™ä¿®é¥°ç¬¦å­—ä¸²å’Œ `Raphael` ç»˜å›¾å®ä¾‹ï¼Œç”±äºæˆ‘ä»¬åŠ äº†é»‘ç™½æ¨¡å¼ï¼Œæ‰€ä»¥ç»™è¿™ä¸ªæ¸²æŸ“æ–¹æ³•åŠ äº†ç¬¬å››ä¸ªå‚æ•°å³ `mode` æ¨¡å¼ï¼Œæ¥æ”¶ `darkã€light` ä¸¤ä¸ªæ¨¡å¼å€¼ï¼Œæ¸²æŸ“å‡ºçš„å›¾è¡¨æ˜¯å¯¹åº”çš„ä¸¤å¥—é¢œè‰²ã€‚å½“ç„¶ï¼Œä¸ä¼ è¿™ä¸ªå‚æ•°ä¹Ÿå¯ä»¥çš„ã€‚

OKï¼Œæ”¾ä¸€ä¸ªæˆ‘è¿™è¾¹æœ¬åœ°ä¿®æ”¹åé‡æ–°æ„å»ºå‹ç¼©å¥½çš„ `regulex` åŒ…ï¼Œå°±æ˜¯ä¸€ä¸ª `AMD` è§„èŒƒçš„ `JS` æ–‡ä»¶ï¼Œåœ°å€åœ¨è¿™é‡Œ ğŸ‘‰ğŸ» [regulex.js](https://github.com/isboyjc/toolsdog/blob/main/public/static/regulex.js)ï¼Œè‡ªè¡Œä¸‹è½½å§ï¼Œè¦æ˜¯ä½ ä¸éœ€è¦æ¨¡å¼åˆ‡æ¢æ—¶å›¾è¡¨é¢œè‰²ä¹Ÿæ”¹å˜çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥å…‹éš†å®˜æ–¹ä»£ç æ„å»ºä¸€ä¸ªå®˜æ–¹åŒ…ï¼Œä¸è¿‡è¿˜å¾—æœ¬åœ°æ„å»ºï¼Œå¤ªéº»çƒ¦ï¼Œç›´æ¥ç”¨æˆ‘è¿™ä¸ªæ”¹è¿‡çš„æ–¹ä¾¿ï¼Œä¸‹è½½ä¸ª `JS` æ–‡ä»¶å°±è¡Œäº†ï¼

æˆ‘ä»¬ä»¥ `CDN` æ–¹å¼å¼•å…¥è¿™ä¸ª `JS` æ–‡ä»¶ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬æ²¡æœ‰ `CDN`ï¼Œæ‰€ä»¥ä¸‹è½½ä¸‹æ¥ `regulex.js` æ–‡ä»¶åï¼Œç›´æ¥æŠŠè¿™ä¸ªæ–‡ä»¶æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„é™æ€èµ„æºæ–‡ä»¶ä¸­ï¼Œå³é¡¹ç›®æ ¹ç›®å½•ä¸‹ `public` æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª `static` æ–‡ä»¶å¤¹ï¼ŒæŠŠ `regulex.js` æ–‡ä»¶æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å³å¯ï¼Œæˆ‘ä»¬é¡¹ç›®ä»£ç é»˜è®¤æ„å»ºæ—¶è¾“å‡ºçš„é™æ€èµ„æºæ–‡ä»¶å°±åœ¨ `dist/static` æ–‡ä»¶å¤¹ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨ `public` æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºçš„æ–‡ä»¶æ„å»ºæ—¶æ˜¯ä¸ä¼šè¢«æ‰“åŒ…é‡å†™çš„ï¼Œè€Œæ˜¯ç›´æ¥å¤åˆ¶æ–‡ä»¶åˆ° `dist` ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ‰“åŒ…æ—¶ï¼Œä¼šç›´æ¥æŠŠ `public` æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ `copy` åˆ°æœ€ç»ˆé¡¹ç›®è¾“å‡ºçš„ `dist` ç›®å½•ä¸‹ï¼Œ`public/static` æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ä¹Ÿå°±ä¼šå…¨éƒ¨ `copy` åˆ° `dist/static` æ–‡ä»¶å¤¹ä¸‹ã€‚

æ–‡ä»¶æ”¾å¥½ä¹‹åï¼Œä¿®æ”¹ä¸‹å…¥å£ `HTML` æ–‡ä»¶ï¼Œå¼•å…¥è¯¥æ–‡ä»¶ï¼ˆæ³¨æ„è¿™é‡Œå¼•å…¥æ˜¯éœ€è¦ç»å¯¹è·¯å¾„çš„ï¼‰ï¼Œå³æ ¹ç›®å½•ä¸‹çš„ `index.html` æ–‡ä»¶å¦‚ä¸‹ï¼š

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<!-- å¼•å…¥regulexåŒ… -->
    <script src="/static/regulex.js"></script>
    <title>Vite App</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
```

ç”±äºè¿™æ˜¯ä¸ª `AMD` è§„èŒƒçš„æ–‡ä»¶ï¼Œå†…ç½®äº† `requireJS`ï¼Œä½¿ç”¨çš„æ—¶å€™ç›´æ¥è°ƒç”¨ `require` æ–¹æ³•å¼•å…¥æ¨¡å—å³å¯ï¼Œå¦‚ä¸‹ä¾‹ï¼š

```jsx
let { parse, visualize, Raphael } = require('regulex')
```

å‡†å¤‡å·¥ä½œå°±ç»ªï¼Œå¯ä»¥å¼€å§‹å†™æ­£åˆ™å¯è§†åŒ–ç»„ä»¶äº†ï¼Œå…¶å®å¾ˆç®€å•å“ˆï¼Œå…ˆæ¥çœ‹ä»£ç ï¼Œåœ¨ `src/views/RegularPage` æ–‡ä»¶å¤¹ä¸‹æ–°å»º `components/RegularVisualization.vue` æ–‡ä»¶ï¼Œç»„ä»¶ä»£ç å¦‚ä¸‹ï¼š

```jsx
<script setup>
// æ³¨æ„éœ€å…¨å±€å¼•å…¥regulex.js
defineExpose({
  exportImage
})

const props = defineProps({
  // æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
  modelValue: {
    type: [Object, null],
    required: true
  },
  // ä¸»é¢˜æ˜æš—æ¨¡å¼
  mode: {
    type: String,
    required: true
  }
})

watch(
  [() => props.modelValue, () => props.mode],
  () => {
    nextTick(() => init(props.modelValue))
  },
  { immediate: true }
)

// å¯¼å‡ºå›¾ç‰‡
function exportImage() {
  let ratio = window.devicePixelRatio || 1
  // è·å–SVGç”»å¸ƒå…ƒç´ 
  let svg = window.graphCt.getElementsByTagName('svg')[0]
  // è·å–SVGç”»å¸ƒå®½é«˜
  let w = svg.clientWidth
  let h = svg.clientHeight
  // åˆ›å»ºImageå¯¹è±¡
  let img = new Image()
  img.width = w
  img.height = h
  img.setAttribute('src', svgToBase64(svg))

  // åˆ›å»ºCanvaså¯¹è±¡
  let canvas = document.createElement('canvas')

  canvas.width = w * ratio
  canvas.height = h * ratio
  let ctx = canvas.getContext('2d')
  ctx.setTransform(ratio, 0, 0, ratio, 0, 0)

  // Imageå¯¹è±¡onloadäº‹ä»¶
  img.onload = function () {
    // ç»™ä¸€ä¸ªèƒŒæ™¯é¢œè‰²ï¼Œä¸ç„¶å¯¼å‡ºçš„å›¾ç‰‡æ˜¯é€æ˜çš„
    let bgColor = props.mode === 'dark' ? '#2e2e31' : '#f2f3f5'
    ctx.fillStyle = bgColor

    // ç»˜åˆ¶Imageå¯¹è±¡åˆ°canvasç”»å¸ƒ
    ctx.fillRect(0, 0, canvas.width, canvas.height)
    ctx.drawImage(img, 0, 0)

    // canvasç”»å¸ƒè½¬ Base64 å¹¶å¯¼å‡º png
    canvasToPictureDownload(canvas, `regexp_visualization_${Date.now()}`)
  }
}

// canvasè½¬å›¾ç‰‡ä¸‹è½½
function canvasToPictureDownload(canvas, name) {
  let a = document.createElement('a')
  // å°†ç”»å¸ƒå†…çš„ä¿¡æ¯å¯¼å‡ºä¸ºpngå›¾ç‰‡æ•°æ® Base64
  a.href = canvas.toDataURL('image/png')
  // è®¾å®šä¸‹è½½åç§°
  a.download = name
  // ç‚¹å‡»è§¦å‘ä¸‹è½½
  a.click()
}

// å°†svgè½¬æ¢ä¸ºbase64
function svgToBase64(svg) {
  return 'data:image/svg+xml,' + encodeURIComponent(svg.outerHTML)
}

// åˆå§‹åŒ–æ–¹æ³•
function init(reg) {
  if (!reg) return
  document.getElementById('graphCt').innerHTML = ''
  let { parse, visualize, Raphael } = require('regulex')
  // åˆ›å»º Raphael å®ä¾‹
  let paper = Raphael('graphCt', 0, 0)
  // æ¸…ç©ºç”»å¸ƒ
  paper.clear()
  try {
    // æ¸²æŸ“æ­£åˆ™å›¾è¡¨
    visualize(parse(reg.source), reg.flags, paper, props.mode)
  } catch (e) {
    if (e instanceof parse.RegexSyntaxError) {
      let msg = ['Error:' + e.message, '']
      if (typeof e.lastIndex === 'number') {
        msg.push(reg)
        msg.push(new Array(e.lastIndex).join('-') + '^')
      }
      console.error(msg.join('\n'))
    } else {
      throw e
    }
  }
}
</script>

<template>
  <div
    v-if="props.modelValue"
    id="graphCt"
    class="w-full overflow-x-auto overflow-y-hidden"
  ></div>
</template>
```

ç®€å•ä»‹ç»ä¸€ä¸‹ä»£ç å¤§æ¦‚é€»è¾‘ï¼Œè¯¥ç»„ä»¶æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ª `modelValue`ï¼Œå³ `v-model` ä¼ å…¥çš„æ˜¯æ­£åˆ™å¯¹è±¡ï¼Œå¦ä¸€æ˜¯ `mode` å³æ¨¡å¼å­—ç¬¦ä¸²ã€‚

æˆ‘ä»¬ä½¿ç”¨ `Vue` çš„ `watch` æ–¹æ³•ç›‘å¬äº†è¿™ä¸¤ä¸ªå‚æ•°ï¼Œç»„ä»¶å†…éƒ¨ç›‘å¬åˆ°å‚æ•°æ”¹å˜æ—¶ï¼Œä¼šé‡æ–°æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•ã€‚

è¯¥ç»„ä»¶çš„æ ¸å¿ƒå°±æ˜¯åˆå§‹åŒ– `init` æ–¹æ³•ï¼Œæ¥ä¸‹æ¥çœ‹ä¸‹è¿™å—çš„ä»£ç ç‰‡æ®µï¼š

```jsx
// åˆå§‹åŒ–æ–¹æ³•
function init(reg) {
  if (!reg) return
  document.getElementById('graphCt').innerHTML = ''
  let { parse, visualize, Raphael } = require('regulex')
  // åˆ›å»º Raphael å®ä¾‹
  let paper = Raphael('graphCt', 0, 0)
  // æ¸…ç©ºç”»å¸ƒ
  paper.clear()
  try {
    // æ¸²æŸ“æ­£åˆ™å›¾è¡¨
    visualize(parse(reg.source), reg.flags, paper, props.mode)
  } catch (e) {
    if (e instanceof parse.RegexSyntaxError) {
      let msg = ['Error:' + e.message, '']
      if (typeof e.lastIndex === 'number') {
        msg.push(reg)
        msg.push(new Array(e.lastIndex).join('-') + '^')
      }
      console.error(msg.join('\n'))
    } else {
      throw e
    }
  }
}
```

æˆ‘ä»¬åœ¨ `Template` æ¨¡æ¿ä¸­åˆ›å»ºäº†ä¸€ä¸ª `div` å…ƒç´ ï¼Œç»™å®ƒäº†ä¸ª `ID` å³ `graphCt`ï¼Œè¿™ä¸ªå…ƒç´ å°±æ˜¯å°†æ¥ `SVG` å›¾è¡¨æ¸²æŸ“çš„ç›®æ ‡ç”»å¸ƒå…ƒç´ äº†ã€‚

ä¸Šé¢åˆå§‹åŒ–æ–¹æ³•å†…æˆ‘ä»¬è·å–åˆ°ç”»å¸ƒå…ƒç´ ï¼Œç„¶åå¯¼å‡º `regulex` åŒ…çš„ä¸‰ä¸ªæ ¸å¿ƒæ–¹æ³•ã€‚

å…ˆä½¿ç”¨ `Raphael` æ–¹æ³•ï¼Œä¼ å…¥ç”»å¸ƒ `ID` å’Œå®½é«˜åˆ›å»º `SVG` ç»˜å›¾åº“å®ä¾‹ï¼Œè¿™é‡Œå®½é«˜ä¼ å…¥ `0` å³å¯ï¼Œå› ä¸ºè¿˜æ²¡æœ‰å†…å®¹ã€‚ç´§æ¥ç€è°ƒç”¨ç»˜å›¾åº“å®ä¾‹ä¸­çš„ `clear` æ–¹æ³•ï¼Œå…ˆæ¸…ç©ºä¸€ä¸‹ç”»å¸ƒï¼Œé¿å…é‡å¤æ¸²æŸ“ã€‚

ç„¶åä½¿ç”¨ `visualize` æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯ç”± `regulex` åº“çš„ `parse` æ–¹æ³•åˆ›å»ºçš„æ­£åˆ™è§£æå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥æ­£åˆ™å¯¹è±¡çš„ä¿®é¥°ç¬¦å­—ç¬¦ä¸²ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥ä¸Šé¢åˆ›å»ºçš„ç»˜å›¾åº“å®ä¾‹ï¼Œç¬¬å››ä¸ªå‚æ•°å³ä¼ å…¥æˆ‘ä»¬çš„ `mode` æ¨¡å¼å­—ç¬¦ä¸²å°±å¯ä»¥äº†ã€‚

æ¯å½“æ­£åˆ™å¯¹è±¡æˆ–è€…æ¨¡å¼å­—ç¬¦ä¸²æ”¹å˜æ—¶å°±ä¼šé‡æ–°æ‰§è¡Œ `init` æ–¹æ³•æ¸²æŸ“ç”»å¸ƒã€‚

ä¸Šé¢ä»£ç  `catch` ä»£ç å—ä¸­æˆ‘ä»¬åšäº†ä¸€äº›é”™è¯¯å¤„ç†ï¼Œä¸ç”¨åœ¨æ„ã€‚OKï¼Œä¸€ä¸ªæ­£åˆ™å¯è§†åŒ–æ¸²æŸ“ç»„ä»¶æ ¸å¿ƒå°±å†™å¥½äº†ï¼Œé‚£ç”±äºæˆ‘ä»¬è¿˜è¦æœ‰ä¸€ä¸ªå¯è§†åŒ–å›¾è¡¨è½¬å›¾ç‰‡ä¸‹è½½çš„åŠŸèƒ½ï¼Œæ‰€ä»¥è¿˜éœ€è¦åœ¨ç»„ä»¶å†…éƒ¨å†™ä¸€ä¸‹ç”»å¸ƒè½¬å›¾ç‰‡ä¸‹è½½æ–¹æ³•æš´éœ²å‡ºå»ã€‚

æ ¸å¿ƒä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```jsx
// å¯¼å‡ºå›¾ç‰‡
function exportImage() {
  let ratio = window.devicePixelRatio || 1
  // è·å–SVGç”»å¸ƒå…ƒç´ 
  let svg = window.graphCt.getElementsByTagName('svg')[0]
  // è·å–SVGç”»å¸ƒå®½é«˜
  let w = svg.clientWidth
  let h = svg.clientHeight
  // åˆ›å»ºImageå¯¹è±¡
  let img = new Image()
  img.width = w
  img.height = h
  img.setAttribute('src', svgToBase64(svg))

  // åˆ›å»ºCanvaså¯¹è±¡
  let canvas = document.createElement('canvas')

  canvas.width = w * ratio
  canvas.height = h * ratio
  let ctx = canvas.getContext('2d')
  ctx.setTransform(ratio, 0, 0, ratio, 0, 0)

  // Imageå¯¹è±¡onloadäº‹ä»¶
  img.onload = function () {
    // ç»™ä¸€ä¸ªèƒŒæ™¯é¢œè‰²ï¼Œä¸ç„¶å¯¼å‡ºçš„å›¾ç‰‡æ˜¯é€æ˜çš„
    let bgColor = props.mode === 'dark' ? '#2e2e31' : '#f2f3f5'
    ctx.fillStyle = bgColor

    // ç»˜åˆ¶Imageå¯¹è±¡åˆ°canvasç”»å¸ƒ
    ctx.fillRect(0, 0, canvas.width, canvas.height)
    ctx.drawImage(img, 0, 0)

    // canvasç”»å¸ƒè½¬ Base64 å¹¶å¯¼å‡º png
    canvasToPictureDownload(canvas, `regexp_visualization_${Date.now()}`)
  }
}

// canvasè½¬å›¾ç‰‡ä¸‹è½½
function canvasToPictureDownload(canvas, name) {
  let a = document.createElement('a')
  // å°†ç”»å¸ƒå†…çš„ä¿¡æ¯å¯¼å‡ºä¸ºpngå›¾ç‰‡æ•°æ® Base64
  a.href = canvas.toDataURL('image/png')
  // è®¾å®šä¸‹è½½åç§°
  a.download = name
  // ç‚¹å‡»è§¦å‘ä¸‹è½½
  a.click()
}

// å°†svgè½¬æ¢ä¸ºbase64
function svgToBase64(svg) {
  return 'data:image/svg+xml,' + encodeURIComponent(svg.outerHTML)
}

defineExpose({
  exportImage
})
```

è¿™å—ä¸€å…±æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼Œç®€å•è§£é‡Šä¸‹ï¼Œç”±äºæˆ‘ä»¬æ¸²æŸ“çš„å›¾è¡¨æ˜¯ `SVG` å›¾è¡¨ï¼Œæ‰€ä»¥ `exportImage` å¯¼å‡ºå›¾ç‰‡æ–¹æ³•ä¸­æˆ‘ä»¬é€šè¿‡ç”»å¸ƒ `ID` å…ˆç›´æ¥è·å–åˆ° `SVG` å…ƒç´ ï¼Œæ‹¿åˆ° `SVG` å…ƒç´ ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å°† `SVG` å…ˆè½¬æˆ `Base64` æ ¼å¼ï¼ˆå³ `svgToBase64` æ–¹æ³•ï¼‰ï¼Œæ‹¿åˆ°äº† `SVG` çš„ `Base64` æ•°æ®ï¼Œæˆ‘ä»¬ç›´æ¥ `new Image` åˆ›å»ºä¸€ä¸ª `Image` å¯¹è±¡æŠŠè¿™ä¸ª `Base64` æ•°æ®ä½œä¸ºè¯¥å¯¹è±¡ `href` å±æ€§å€¼å†™å…¥ï¼Œ`Image` å¯¹è±¡å®½é«˜è·å–ä¸€ä¸‹ `SVG` ç”»å¸ƒï¼Œä½¿ç”¨ `SVG` ç”»å¸ƒçš„å®½é«˜å³å¯ã€‚

æ¥ç€æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª `Canvas` ç”»å¸ƒå¯¹è±¡ï¼Œåœ¨ `Image` å¯¹è±¡åŠ è½½å®Œæˆåï¼ŒæŠŠ `Image` å¯¹è±¡ç»˜åˆ¶åˆ° `Canvas` ç”»å¸ƒä¸­ï¼Œæœ€åè°ƒç”¨ `canvasToPictureDownload` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å³æŠŠ `Canvas` ç”»å¸ƒè½¬æˆ `png` æ ¼å¼çš„ `Base64` æ•°æ®ï¼Œç„¶å `JS` åˆ›å»ºä¸€ä¸ª `a` æ ‡ç­¾å†™å…¥ `href` å€¼ï¼Œå†ç»™ a æ ‡ç­¾å¯¹è±¡å†™å…¥ `download` å±æ€§ï¼Œå…¶å±æ€§å€¼ä¸ºä¸‹è½½çš„é»˜è®¤å›¾ç‰‡åï¼Œè¿™é‡Œæˆ‘ä»¬ç»™äº†ä¸€ä¸ªæ—¶é—´æˆ³ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œæœ€åæ‰‹åŠ¨è§¦å‘ä¸‹ `click` ç‚¹å‡»äº‹ä»¶è§¦å‘ä¸‹è½½å³å¯ã€‚

æœ€åæˆ‘ä»¬åœ¨å¯è§†åŒ–ç»„ä»¶ä¸­æš´éœ²å‡ºäº†å›¾ç‰‡ä¸‹è½½æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š

```jsx
defineExpose({
  exportImage
})

// ...
```

**PSï¼š** ç”±äºç»„ä»¶æˆ‘ä»¬æ—¶ä½¿ç”¨ `setup` æ¨¡å¼å†™çš„ï¼Œæ‰€ä»¥æƒ³è¦æš´éœ²æ–¹æ³•ï¼Œå¿…é¡»ä½¿ç”¨ `defineExpose` æ–¹æ³•æ‰‹åŠ¨æš´éœ²ã€‚

è¿˜æœ‰ä¹‹å‰æ–‡ç« ä¹Ÿè¯´è¿‡ï¼šå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº† `setup`ï¼Œé‚£è¯•æƒ³ `setup` åœ¨ `Vue` ç»„ä»¶ä¸­çš„å“ªä¸ªæ—¶æœŸæ‰ä¼šè°ƒç”¨ï¼Ÿå®ƒæ˜¯åœ¨ç»„ä»¶è°ƒç”¨æ—¶è¢«è°ƒç”¨ï¼Œå¹¶ä¸”æ˜¯åœ¨ç»„ä»¶çš„ `beforeCreate` ç”Ÿå‘½å‘¨æœŸä¹‹å‰æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æƒ³è¦æ‹¿åˆ° `setup` ä¸­çš„æ•°æ®ï¼Œé‚£è‡³å°‘å¾—ç­‰ç»„ä»¶è°ƒç”¨äº†æ‰è¡Œï¼Œç»„ä»¶è¿˜æ²¡è°ƒç”¨çš„æ—¶å€™ï¼Œæ˜¯ç»å¯¹è·å–ä¸äº† `setup` ä¸­å±æ€§æˆ–æ–¹æ³•çš„ã€‚

è¿™æ ·çš„è¯æˆ‘ä»¬åœ¨çˆ¶çº§ç»„ä»¶ä¸­æ‹¿åˆ°ç»„ä»¶å®ä¾‹å¯¹è±¡åå°±å¯ä»¥è°ƒç”¨å…¶å¯¼å‡ºçš„ `exportImage` æ–¹æ³•äº†ï¼ï¼

OKï¼Œç»„ä»¶å†™å®Œäº†ï¼Œæ¥åœ¨æ­£åˆ™é¡µé¢ `RegularPage/index.vue` æ–‡ä»¶ä¸­ä½¿ç”¨ä¸€ä¸‹ã€‚

ç”±äºè¿™é‡Œè¦ç”¨åˆ°æ¨¡å¼å±æ€§ï¼Œæ‰€ä»¥ç›´æ¥åœ¨æ–‡ä»¶å¼€å¤´ï¼Œéœ€è¦å¯¼å…¥æˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç« ä¸­åˆ›å»ºçš„ `pinia system` æ¨¡å—ä¸­çš„å½“å‰æ¨¡å¼å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š

```jsx
import { useSystemStore } from '@/stores/system'
const { currentMode } = storeToRefs(useSystemStore())
```

è¿™é‡Œæœ‰ä¸ªé—®é¢˜å“ˆï¼Œæˆ‘ä»¬è¿™é‡Œ `visualize` æ–¹æ³•çš„å‚æ•° `mode` åªæ”¯æŒä¼ å…¥å­—ç¬¦ä¸² `dark` æˆ–è€… `light`ï¼Œä½†æ˜¯æˆ‘ä»¬çš„å½“å‰æ¨¡å¼å¯¹è±¡ä¸­ `name` å±æ€§åœ¨è‡ªåŠ¨æ¨¡å¼ä¸‹ä¼šæ˜¯ `auto` ï¼Œè¿™å°±ä¼šå­˜åœ¨é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è·å–åˆ° `auto` æ¨¡å¼ä¸‹åˆ°åº•æ˜¯ `dark` è¿˜æ˜¯ `light`ã€‚

æ‰€ä»¥æˆ‘ä»¬éœ€è¦å€ŸåŠ© `VueUse` çš„å¦ä¸€ä¸ªæ–¹æ³• `useDark` é€šè¿‡å’Œä¹‹å‰ `useColorMode` æ–¹æ³•ä¸€æ ·çš„å±æ€§é…ç½®æ¥è·å–å½“å‰æ¨¡å¼ï¼Œå…¶å® `useDark` æ–¹æ³•å†…éƒ¨ä¹Ÿæ˜¯é  `useColorMode` æ–¹æ³•å®ç°çš„ï¼Œåœ¨ `useDark` æ–¹æ³•æºç ä¸­ï¼Œä¼šä½¿ç”¨ `useColorMode` ä¼ å…¥é…ç½®é¡¹ç”Ÿæˆä¸€ä¸ªå“åº”å¼çš„ `mode` å±æ€§ï¼Œè€Œ `useDark` æ–¹æ³•è¿”å›çš„ `isDark` å±æ€§ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œå…¶æºç æ ¸å¿ƒå¤§è‡³å¦‚ä¸‹ï¼š

```jsx
export function useDark(options = {}) {

  const mode = useColorMode({
    ...options,
    // ...
  })

  const isDark = computed({
    get() {
      return mode.value === 'dark'
    },
    set(v) {
      // ...
    },
  })

  return isDark
}
```

çœ‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œè·‘é¢˜äº†ï¼Œå›åˆ°æ­£é¢˜å“ˆã€‚æˆ‘ä»¬æ¥å†™ä¸‹å½“å‰æ¨¡å¼è·å–çš„ä»£ç ï¼š

```jsx
// æ˜¯å¦æ˜¯é»‘æš—æ¨¡å¼
const isDark = useDark({
  selector: 'body',
  attribute: 'arco-theme',
  valueDark: 'dark',
  valueLight: 'light',
  initialValue: currentMode.value?.name,
  storageKey: null
})
// å½“å‰é¢œè‰²æ¨¡å¼
const mode = computed(() => {
  if (currentMode.value?.name == 'auto') {
    return isDark.value ? 'dark' : 'light'
  }
  return currentMode.value?.name
})
```

OKï¼Œè¿™æ ·çš„è¯æ¯å½“ `pinia` ä¸­å…¨å±€çš„å½“å‰æ¨¡å¼å¯¹è±¡æ”¹å˜ï¼Œæˆ‘ä»¬è¿™ä¸ªé¡µé¢çš„æ¨¡å¼å€¼ä¹Ÿä¼šè·Ÿç€æ”¹å˜ï¼Œå¹¶ä¸”å½“å…¨å±€æ¨¡å¼å€¼ä¸º `auto` æ—¶ï¼Œæˆ‘ä»¬è¿™é‡Œä¹Ÿå¯ä»¥çŸ¥é“å®ƒåˆ°åº•æ˜¯ `dark` è¿˜æ˜¯ `light`ã€‚

æ‹¿åˆ°äº†å½“å‰æ¨¡å¼æ•°æ®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ `Template` æ¨¡æ¿å°±å¯ä»¥ä½¿ç”¨ä¸‹ç»„ä»¶äº†ã€‚

è¿˜è®°å¾—å¼€å§‹æ—¶æˆ‘ä»¬æŠŠæ•´ä¸ªæ­£åˆ™çš„é¡µé¢åˆ†ä¸ºä¸Šä¸­ä¸‹ä¸‰ä¸ªæ¨¡å—å—ï¼Œä¸­é—´é‚£ä¸ªæ¨¡å—å°±æ˜¯æ”¾å¯è§†åŒ–å›¾è¡¨çš„ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠå¯è§†åŒ–ç»„ä»¶ä»£ç å¡åˆ°ä¸­é—´æ¨¡å—çš„ `div` ä¸­ï¼ŒåŒ¿åç»„ä»¶çš„ç»„ä»¶åé»˜è®¤å°±æ˜¯æ–‡ä»¶åå“ˆï¼Œç»„ä»¶è¿˜è¦åšæ ¡éªŒï¼Œåªæœ‰ `visualization` å±æ€§ä¸º `true` æ—¶æ‰åŠ è½½å¯è§†åŒ–ç»„ä»¶ï¼ˆ`reg` è¿˜æ˜¯æˆ‘ä»¬ä¹‹å‰å†™çš„é‚£ä¸ªæ­£åˆ™å¯¹è±¡å“ˆï¼‰ï¼š

```html
<div class="mt-20px bg-[var(--color-fill-2)]">
  <RegularVisualization
    ref="regVisualizationRef"
    v-if="visualization"
    v-model="reg"
    :mode="mode"
  />
</div>
```

è¶çƒ­æ‰“é“ï¼Œå†æ¥ç»™ä¸‹è½½å¯è§†åŒ–å›¾ç‰‡çš„æŒ‰é’®å†™ä¸€ä¸‹ï¼ŒåŒæ ·å’Œä¸Šé¢å…¶ä»–æŒ‰é’®å·®ä¸å¤šï¼Œæ”¾åœ¨æ˜¯å¦æ˜¾ç¤ºå¯è§†åŒ–é¢„è§ˆæŒ‰é’®å³è¾¹å°±è¡Œï¼Œä¸è¿‡è¿™ä¸ªä¸‹è½½å›¾ç‰‡çš„æŒ‰é’®ä¹Ÿéœ€è¦æ ¡éªŒï¼Œåªæœ‰å½“ `reg` æ­£åˆ™å¯¹è±¡å­˜åœ¨ä¸”æ˜¯å¦æ˜¾ç¤ºå¯è§†åŒ–é¢„è§ˆçš„ `visualization` å±æ€§å€¼ä¸º `true` æ—¶æ‰æ˜¾ç¤ºï¼Œå¹¶ä¸”æˆ‘ä»¬ç»™æŒ‰é’®åŠ äº†ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ `exportRegVisualizationToImg`ï¼Œå³ä¸‹è½½å›¾ç‰‡æ–¹æ³•ï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š

```html
<a-tooltip content="ä¸‹è½½è§£æå›¾ç‰‡" position="bottom">
  <a-button
    :size="size"
    class="ml-10px"
    v-if="visualization && reg"
    @click="exportRegVisualizationToImg"
  >
    <template #icon>
      <icon-icon-park-outline-down-picture />
    </template>
  </a-button>
</a-tooltip>
```

OKï¼Œä¸Šé¢æˆ‘ä»¬å†™å¯è§†åŒ–ç»„ä»¶æ—¶ï¼Œåœ¨å¯è§†åŒ–ç»„ä»¶æ ‡ç­¾ä¸­è¿˜å†™äº†ä¸ª `ref` å±æ€§ï¼Œå€¼ä¸º `regVisualizationRef`ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é€šè¿‡ `ref` å±æ€§æ¥è·å–ä¸€ä¸‹å¯è§†åŒ–ç»„ä»¶å®ä¾‹ï¼Œå’Œ `Vue2` çš„ `refs` ç±»ä¼¼ï¼Œä½†æ˜¯åœ¨ `setup` ä¸­æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå’Œç»„ä»¶ä¸­ `ref` å±æ€§å€¼ `regVisualizationRef` åŒåçš„ `ref()` æ•°æ®ï¼Œé»˜è®¤æ˜¯ `null`ï¼Œå½“ç»„ä»¶æ¸²æŸ“ä¹‹åæ­¤å±æ€§å€¼å³ç»„ä»¶å®ä¾‹å¯¹è±¡ã€‚

ç„¶åæˆ‘ä»¬è¡¥ä¸‹ä¸‹è½½æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å†…å®¹ï¼Œåœ¨ä¸‹è½½æŒ‰é’®ç‚¹å‡»äº‹ä»¶ä¸­è°ƒç”¨å¯è§†åŒ–ç»„ä»¶å®ä¾‹æŠ›å‡ºçš„ä¸‹è½½å›¾ç‰‡æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š

```jsx
// å¯è§†åŒ–ç»„ä»¶å®ä¾‹
const regVisualizationRef = ref(null)

// å¯¼å‡ºæ­£åˆ™å¯è§†åŒ–å›¾ç‰‡
const exportRegVisualizationToImg = () => {
  regVisualizationRef.value && regVisualizationRef.value?.exportImage()
}
```

å¯è§†åŒ–æ¨¡å—åˆ°æ­¤å·®ä¸å¤šå°±å†™å®Œäº†ï¼Œçœ‹ä¸‹å®Œæ•´ä»£ç ï¼š

```html
<script setup>
import * as regPresetsObj from '@/utils/regexp.js'
import { useSystemStore } from '@/stores/system'
const { currentMode } = storeToRefs(useSystemStore())

// å¤§å°
const size = ref('large')
// æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
const reg = ref(null)
// æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²
const regStr = ref('')
// æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦
const regFlag = ref([])
watchEffect(() => {
  try {
    reg.value = regStr.value
      ? new RegExp(regStr.value, regFlag.value.join(''))
      : null
  } catch (err) {
    reg.value = null
  }
})

// é¢„è®¾è‡ªåŠ¨æœç´¢
const auto = ref(true)
// æ­£åˆ™é¢„è®¾åˆ—è¡¨
const regPresets = ref([])
// æ­£åˆ™é¢„è®¾åŒ¹é…æ–¹æ³•
const regPresetMatch = value => {
  if (value && auto.value) {
    regPresets.value = [...Object.values(regPresetsObj)]
      .filter(r => r.name.includes(value) || r.source.includes(value))
      .map(v => {
        return {
          label: v.name,
          regexp: v,
          value: v.source
        }
      })
  } else {
    regPresets.value = []
  }
}
// æ­£åˆ™é¢„è®¾é€‰ä¸­æ–¹æ³•
const regPresetSelect = r => {
  let selected = regPresets.value.find(v => v.value === r)
  if (selected) regFlag.value = selected.regexp.flags.split('')
}

// å¾…åŒ¹é…å­—ç¬¦ä¸²
const matchStr = ref('')
// åŒ¹é…ç»“æœ
const matchingResults = computed(
  () => matchStr.value.match(reg.value)?.filter(v => v) || []
)
// åŒ¹é…ç»“æœæ ¼å¼åŒ–
const matchingFormat = computed(() => {
  let res = '',
    str = matchStr.value
  let n = 1
  matchingResults.value.forEach(v => {
    if (n > 4) n = 1
    let matchStr = str.substr(0, v.length + str.indexOf(v))
    str = str.substr(v.length + str.indexOf(v))
    res += matchStr.replace(
      v,
      `<span class="matching matching${n}">${v}</span>`
    )
    n++
  })

  return res + str
})

// å¯è§†åŒ–
const visualization = ref(true)
// å¯è§†åŒ–ç»„ä»¶å®ä¾‹
const regVisualizationRef = ref(null)
// æ˜¯å¦æ˜¯é»‘æš—æ¨¡å¼
const isDark = useDark({
  selector: 'body',
  attribute: 'arco-theme',
  valueDark: 'dark',
  valueLight: 'light',
  initialValue: currentMode.value?.name,
  storageKey: null
})
// å½“å‰é¢œè‰²æ¨¡å¼
const mode = computed(() => {
  if (currentMode.value?.name == 'auto') {
    return isDark.value ? 'dark' : 'light'
  }
  return currentMode.value?.name
})
// å¯¼å‡ºæ­£åˆ™å¯è§†åŒ–å›¾ç‰‡
const exportRegVisualizationToImg = () => {
  regVisualizationRef.value && regVisualizationRef.value?.exportImage()
}
</script>
<template>
  <div class="max-w-1200px w-full p-20px box-border">
    <div class="flex justify-start items-center">
      <a-tooltip
        :content="`ç‚¹å‡»${auto ? 'å…³é—­' : 'å¼€å¯'}é¢„è®¾æ­£åˆ™è‡ªåŠ¨åŒ¹é…`"
        position="bottom"
      >
        <a-button :size="size" @click="auto = !auto">
          <template #icon>
            <icon-material-symbols-astrophotography-auto
              :class="auto ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
      </a-tooltip>

      <a-auto-complete
        class="ml-10px"
        v-model="regStr"
        :data="regPresets"
        @search="regPresetMatch"
        @select="regPresetSelect"
        :placeholder="`è¯·è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼${
          auto ? 'æˆ–è¾“å…¥æ–‡å­—é€‰æ‹©è‡ªåŠ¨åŒ¹é…çš„é¢„è®¾æ­£åˆ™' : ''
        }`"
        allow-clear
        :size="size"
      >
        <template #prepend>
          <a-tooltip
            :content="reg ? 'æ­£åˆ™è¡¨è¾¾å¼æ­£ç¡®' : 'æ­£åˆ™è¡¨è¾¾å¼æœ‰è¯¯'"
            position="bottom"
            mini
          >
            <icon-jam-triangle-danger-f
              class="text-[rgb(var(--orange-6))]"
              v-if="!reg"
            />
            <icon-mdi-hand-okay class="text-[rgb(var(--green-6))]" v-else />
          </a-tooltip>

          <span class="ml-5px">/</span>
        </template>
        <template #append>
          <span> /{{ reg?.flags || regFlag?.join('') }}</span>
        </template>
      </a-auto-complete>

      <a-popover title="é€‰æ‹©ä¿®é¥°ç¬¦" position="bl">
        <a-button :size="size" class="ml-10px">
          <template #icon>
            <icon-mdi-filter-multiple
              :class="regFlag.length > 0 ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
        <template #content>
          <div class="min-w-200px">
            <a-checkbox-group
              :size="size"
              v-model="regFlag"
              direction="vertical"
            >
              <a-checkbox value="g"> -gï¼šå…¨å±€åŒ¹é… </a-checkbox>
              <a-checkbox value="i"> -iï¼šå¿½ç•¥å¤§å°å†™</a-checkbox>
              <a-checkbox value="m"> -mï¼šå¤šè¡ŒåŒ¹é…</a-checkbox>
              <a-checkbox value="s"> -sï¼šç‰¹æ®Šå­—ç¬¦. åŒ…å«æ¢è¡Œç¬¦</a-checkbox>
            </a-checkbox-group>
          </div>
        </template>
      </a-popover>

      <a-tooltip
        :content="`ç‚¹å‡»${visualization ? 'å…³é—­' : 'å¼€å¯'}å¯è§†åŒ–è§£æ`"
        position="bottom"
      >
        <a-button
          :size="size"
          class="ml-10px"
          @click="visualization = !visualization"
        >
          <template #icon>
            <icon-ic-sharp-visibility
              class="text-[rgb(var(--arcoblue-6))]"
              v-if="visualization"
            />
            <icon-ic-sharp-visibility-off v-else />
          </template>
        </a-button>
      </a-tooltip>

      <a-tooltip content="ä¸‹è½½è§£æå›¾ç‰‡" position="bottom">
        <a-button
          :size="size"
          class="ml-10px"
          v-if="visualization && reg"
          @click="exportRegVisualizationToImg"
        >
          <template #icon>
            <icon-icon-park-outline-down-picture />
          </template>
        </a-button>
      </a-tooltip>
    </div>

    <div class="mt-20px bg-[var(--color-fill-2)]">
      <RegularVisualization
        ref="regVisualizationRef"
        v-if="visualization"
        v-model="reg"
        :mode="mode"
      />
    </div>

    <div class="w-full mt-20px">
      <a-textarea
        v-model="matchStr"
        default-value=""
        placeholder="è¯·è¾“å…¥è¦åŒ¹é…çš„å­—ç¬¦ä¸²"
        :auto-size="{
          minRows: 3,
          maxRows: 6
        }"
      />

      <div
        class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
        v-html="matchingFormat || 'æ— åŒ¹é…ç»“æœ'"
      ></div>

      <div
        v-if="matchingResults.length > 0"
        class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
      >
        <div>å…± {{ matchingResults.length }} å¤„åŒ¹é…ï¼š</div>
        <div v-for="(res, i) of matchingResults" :key="i">{{ res }}</div>
      </div>
    </div>
  </div>
</template>

<style>
.matching {
  @apply px-0px rounded-4px box-border;
}
.matching1 {
  @apply bg-[rgb(var(--arcoblue-2))];
}
.matching2 {
  @apply bg-[rgb(var(--green-2))];
}
.matching3 {
  @apply bg-[rgb(var(--orange-2))];
}
.matching4 {
  @apply bg-[rgb(var(--red-2))];
}
</style>
```

ä¿å­˜åˆ·æ–°é¡µé¢ï¼Œçœ‹ä¸‹æ•ˆæœã€‚

`dark` æ¨¡å¼ä¸‹ï¼š

![http://qiniuimages.isboyjc.com/picgo/202211290618976.png](http://qiniuimages.isboyjc.com/picgo/202211290618976.png)

`light` æ¨¡å¼ä¸‹ï¼š

![http://qiniuimages.isboyjc.com/picgo/202211290619240.png](http://qiniuimages.isboyjc.com/picgo/202211290619240.png)

## æ­£åˆ™å¤åˆ¶

æœ€åæ¥ä¸€ä¸ªå¤åˆ¶çš„å°åŠŸèƒ½ï¼Œå°±æ˜¯å¼€å¤´æˆ‘ä»¬è¯´çš„ï¼Œæ­£åˆ™å­˜åœ¨æ—¶ï¼Œç¬¬ä¸€è¡Œæœ€å³è¾¹è¦æ˜¾ç¤ºä¸€ä¸ª `copy` æŒ‰é’®ï¼Œç”¨æ¥æŠŠå½“å‰æ­£åˆ™å¤åˆ¶åˆ°å‰ªåˆ‡æ¿ã€‚

ä»£ç å¾ˆç®€å•ï¼Œè¿˜æ˜¯åœ¨ `RegularPage/index.vue` æ­£åˆ™é¡µé¢ï¼Œ`script setup` ä¸­æ–°å¢ `JS`ï¼š

```jsx
const { copy, text, isSupported } = useClipboard({ source: reg })
// Copyæ­£åˆ™åˆ°å‰ªè´´æ¿
const regCopy = async () => {
  if (!isSupported.value) return AMessage.info('ä¸æ”¯æŒå¤åˆ¶')
  await copy()
  AMessage.success('å¤åˆ¶æˆåŠŸï¼š' + text.value)
}
```

æ¥ç€å’Œä¹‹å‰çš„æŒ‰é’®ä¸€æ ·ï¼Œåœ¨ `Template` æ¨¡æ¿çš„ä¸Šæ¨¡å—æœ€å³ä¾§åŠ ä¸ªå¤åˆ¶å›¾æ ‡æŒ‰é’®ï¼Œåœ¨ `reg` å­˜åœ¨æ—¶æ˜¾ç¤ºï¼Œæ–°å¢æ¨¡æ¿å†…å®¹å¦‚ä¸‹ï¼š

```html
<a-tooltip content="ç‚¹å‡» copy æ­£åˆ™è¡¨è¾¾å¼" position="bottom">
  <a-button :size="size" class="ml-10px" v-if="reg" @click="regCopy">
    <template #icon>
      <icon-icon-park-solid-copy />
    </template>
  </a-button>
</a-tooltip>
```

è¿˜æ˜¯å€ŸåŠ©äº† `VueUse` çš„ `useClipboard` æ–¹æ³•å“ˆï¼Œè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥å¤§å®¶çœ‹çœ‹å°±è¡Œï¼Œæˆ–è€…å»åˆ·ä¸‹æ–‡æ¡£ï¼Œå¤åˆ¶åˆ°å‰ªåˆ‡æ¿æœ‰å…¼å®¹æ€§é—®é¢˜ä»¥åŠæµè§ˆå™¨ç­–ç•¥é—®é¢˜ï¼ˆ ç”Ÿäº§ç¯å¢ƒä¸‹ `http` ä¸å¯å¤åˆ¶ï¼Œå¾— `https` æ‰è¡Œï¼Œå¼€å‘ç¯å¢ƒæ²¡äº‹ï¼‰ã€‚

æˆ‘ä»¬ä½¿ç”¨è¯¥æ–¹æ³•è¿”å›çš„ `isSupported` å±æ€§åˆ¤æ–­ä¸‹å½“å‰é¡µé¢æ˜¯å¦æ”¯æŒå¤åˆ¶åˆ°å‰ªåˆ‡æ¿ã€‚

è¿”å›çš„ `copy` æ–¹æ³•å°±å¦‚æ–¹æ³•åç”¨æ¥åšå¤åˆ¶ã€‚

è¿”å›çš„ `text` å±æ€§æ˜¯å¤åˆ¶æˆåŠŸåå‰ªåˆ‡æ¿çš„å€¼ã€‚ 

å…ˆçœ‹ä¸‹å¤åˆ¶çš„æ•ˆæœï¼š

![http://qiniuimages.isboyjc.com/picgo/202211290637203.png](http://qiniuimages.isboyjc.com/picgo/202211290637203.png)

åˆ°æ­¤æ­£åˆ™æ ¡éªŒé¡µé¢åŠŸèƒ½å°±å…ˆå‘Šä¸€æ®µè½äº†ï¼Œå®Œæ•´ä»£ç åœ¨ä¸‹ä¸€å°èŠ‚çœ‹å§

## å®Œæ•´ä»£ç 

```html
<script setup>
import * as regPresetsObj from '@/utils/regexp.js'
import { useSystemStore } from '@/stores/system'
const { currentMode } = storeToRefs(useSystemStore())

// å¤§å°
const size = ref('large')
// æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
const reg = ref(null)
// æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²
const regStr = ref('')
// æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦
const regFlag = ref([])
watchEffect(() => {
  try {
    reg.value = regStr.value
      ? new RegExp(regStr.value, regFlag.value.join(''))
      : null
  } catch (err) {
    reg.value = null
  }
})

// é¢„è®¾è‡ªåŠ¨æœç´¢
const auto = ref(true)
// æ­£åˆ™é¢„è®¾åˆ—è¡¨
const regPresets = ref([])
// æ­£åˆ™é¢„è®¾åŒ¹é…æ–¹æ³•
const regPresetMatch = value => {
  if (value && auto.value) {
    regPresets.value = [...Object.values(regPresetsObj)]
      .filter(r => r.name.includes(value) || r.source.includes(value))
      .map(v => {
        return {
          label: v.name,
          regexp: v,
          value: v.source
        }
      })
  } else {
    regPresets.value = []
  }
}
// æ­£åˆ™é¢„è®¾é€‰ä¸­æ–¹æ³•
const regPresetSelect = r => {
  let selected = regPresets.value.find(v => v.value === r)
  if (selected) regFlag.value = selected.regexp.flags.split('')
}

// å¾…åŒ¹é…å­—ç¬¦ä¸²
const matchStr = ref('')
// åŒ¹é…ç»“æœ
const matchingResults = computed(
  () => matchStr.value.match(reg.value)?.filter(v => v) || []
)
// åŒ¹é…ç»“æœæ ¼å¼åŒ–
const matchingFormat = computed(() => {
  let res = '',
    str = matchStr.value
  let n = 1
  matchingResults.value.forEach(v => {
    if (n > 4) n = 1
    let matchStr = str.substr(0, v.length + str.indexOf(v))
    str = str.substr(v.length + str.indexOf(v))
    res += matchStr.replace(
      v,
      `<span class="matching matching${n}">${v}</span>`
    )
    n++
  })

  return res + str
})

// å¯è§†åŒ–
const visualization = ref(true)
// å¯è§†åŒ–ç»„ä»¶å®ä¾‹
const regVisualizationRef = ref(null)
// æ˜¯å¦æ˜¯é»‘æš—æ¨¡å¼
const isDark = useDark({
  selector: 'body',
  attribute: 'arco-theme',
  valueDark: 'dark',
  valueLight: 'light',
  initialValue: currentMode.value?.name,
  storageKey: null
})
// å½“å‰é¢œè‰²æ¨¡å¼
const mode = computed(() => {
  if (currentMode.value?.name == 'auto') {
    return isDark.value ? 'dark' : 'light'
  }
  return currentMode.value?.name
})
// å¯¼å‡ºæ­£åˆ™å¯è§†åŒ–å›¾ç‰‡
const exportRegVisualizationToImg = () => {
  regVisualizationRef.value && regVisualizationRef.value?.exportImage()
}

const { copy, text, isSupported } = useClipboard({ source: reg })
// Copyæ­£åˆ™åˆ°å‰ªè´´æ¿
const regCopy = async () => {
  if (!isSupported.value) return AMessage.info('ä¸æ”¯æŒå¤åˆ¶')
  await copy()
  AMessage.success('å¤åˆ¶æˆåŠŸï¼š' + text.value)
}
</script>
<template>
  <div class="max-w-1200px w-full p-20px box-border">
    <div class="flex justify-start items-center">
      <a-tooltip
        :content="`ç‚¹å‡»${auto ? 'å…³é—­' : 'å¼€å¯'}é¢„è®¾æ­£åˆ™è‡ªåŠ¨åŒ¹é…`"
        position="bottom"
      >
        <a-button :size="size" @click="auto = !auto">
          <template #icon>
            <icon-material-symbols-astrophotography-auto
              :class="auto ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
      </a-tooltip>

      <a-auto-complete
        class="ml-10px"
        v-model="regStr"
        :data="regPresets"
        @search="regPresetMatch"
        @select="regPresetSelect"
        :placeholder="`è¯·è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼${
          auto ? 'æˆ–è¾“å…¥æ–‡å­—é€‰æ‹©è‡ªåŠ¨åŒ¹é…çš„é¢„è®¾æ­£åˆ™' : ''
        }`"
        allow-clear
        :size="size"
      >
        <template #prepend>
          <a-tooltip
            :content="reg ? 'æ­£åˆ™è¡¨è¾¾å¼æ­£ç¡®' : 'æ­£åˆ™è¡¨è¾¾å¼æœ‰è¯¯'"
            position="bottom"
            mini
          >
            <icon-jam-triangle-danger-f
              class="text-[rgb(var(--orange-6))]"
              v-if="!reg"
            />
            <icon-mdi-hand-okay class="text-[rgb(var(--green-6))]" v-else />
          </a-tooltip>

          <span class="ml-5px">/</span>
        </template>
        <template #append>
          <span> /{{ reg?.flags || regFlag?.join('') }}</span>
        </template>
      </a-auto-complete>

      <a-popover title="é€‰æ‹©ä¿®é¥°ç¬¦" position="bl">
        <a-button :size="size" class="ml-10px">
          <template #icon>
            <icon-mdi-filter-multiple
              :class="regFlag.length > 0 ? 'text-[rgb(var(--arcoblue-6))]' : ''"
            />
          </template>
        </a-button>
        <template #content>
          <div class="min-w-200px">
            <a-checkbox-group
              :size="size"
              v-model="regFlag"
              direction="vertical"
            >
              <a-checkbox value="g"> -gï¼šå…¨å±€åŒ¹é… </a-checkbox>
              <a-checkbox value="i"> -iï¼šå¿½ç•¥å¤§å°å†™</a-checkbox>
              <a-checkbox value="m"> -mï¼šå¤šè¡ŒåŒ¹é…</a-checkbox>
              <a-checkbox value="s"> -sï¼šç‰¹æ®Šå­—ç¬¦. åŒ…å«æ¢è¡Œç¬¦</a-checkbox>
            </a-checkbox-group>
          </div>
        </template>
      </a-popover>

      <a-tooltip
        :content="`ç‚¹å‡»${visualization ? 'å…³é—­' : 'å¼€å¯'}å¯è§†åŒ–è§£æ`"
        position="bottom"
      >
        <a-button
          :size="size"
          class="ml-10px"
          @click="visualization = !visualization"
        >
          <template #icon>
            <icon-ic-sharp-visibility
              class="text-[rgb(var(--arcoblue-6))]"
              v-if="visualization"
            />
            <icon-ic-sharp-visibility-off v-else />
          </template>
        </a-button>
      </a-tooltip>

      <a-tooltip content="ä¸‹è½½è§£æå›¾ç‰‡" position="bottom">
        <a-button
          :size="size"
          class="ml-10px"
          v-if="visualization && reg"
          @click="exportRegVisualizationToImg"
        >
          <template #icon>
            <icon-icon-park-outline-down-picture />
          </template>
        </a-button>
      </a-tooltip>

      <a-tooltip content="ç‚¹å‡» copy æ­£åˆ™è¡¨è¾¾å¼" position="bottom">
        <a-button :size="size" class="ml-10px" v-if="reg" @click="regCopy">
          <template #icon>
            <icon-icon-park-solid-copy />
          </template>
        </a-button>
      </a-tooltip>
    </div>

    <div class="mt-20px bg-[var(--color-fill-2)]">
      <RegularVisualization
        ref="regVisualizationRef"
        v-if="visualization"
        v-model="reg"
        :mode="mode"
      />
    </div>

    <div class="w-full mt-20px">
      <a-textarea
        v-model="matchStr"
        default-value=""
        placeholder="è¯·è¾“å…¥è¦åŒ¹é…çš„å­—ç¬¦ä¸²"
        :auto-size="{
          minRows: 3,
          maxRows: 6
        }"
      />

      <div
        class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
        v-html="matchingFormat || 'æ— åŒ¹é…ç»“æœ'"
      ></div>

      <div
        v-if="matchingResults.length > 0"
        class="w-full min-h-100px bg-[var(--color-fill-2)] whitespace-pre-wrap break-words indent-0 leading-22px mt-20px px-12px py-4px box-border"
      >
        <div>å…± {{ matchingResults.length }} å¤„åŒ¹é…ï¼š</div>
        <div v-for="(res, i) of matchingResults" :key="i">{{ res }}</div>
      </div>
    </div>
  </div>
</template>

<style>
.matching {
  @apply px-0px rounded-4px box-border;
}
.matching1 {
  @apply bg-[rgb(var(--arcoblue-2))];
}
.matching2 {
  @apply bg-[rgb(var(--green-2))];
}
.matching3 {
  @apply bg-[rgb(var(--orange-2))];
}
.matching4 {
  @apply bg-[rgb(var(--red-2))];
}
</style>
```

å¦‚æœå¤§å®¶è·Ÿç€å†™äº†çš„è¯ï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰äº²èº«ä½“éªŒåˆ° `ComponsitionAPI` çš„ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„å°ä¼˜ç‚¹ï¼Œä¸Šé¢ `JS` ä»£ç ä¸­æˆ‘æŠŠä¸åŒçš„å°åŠŸèƒ½æ¨¡å—ä»¥ç©ºç™½è¡Œåˆ†å¼€äº†ï¼Œæ¯ä¸ªå°æ¨¡å—ç”¨åˆ°çš„å±æ€§å€¼ã€æ–¹æ³•éƒ½åœ¨ä¸€å—ï¼Œä¸éœ€è¦åƒ `OptionsAPI` é‚£æ ·ä¸Šä¸‹æ¥å›è·³è½¬å»æ”¹ä¸œè¥¿ã€‚å½“ç„¶ä¹Ÿå¯èƒ½æ²¡å•¥æ„Ÿè§‰ï¼Œæ¯•ç«Ÿè¿™ä¸ªé¡µé¢åŠŸèƒ½å¾ˆå°‘ï¼Œæœ‰ç‚¹ç®€å•ï¼Œæ²¡äº‹å„¿ï¼Œåé¢è¿˜æœ‰æœºä¼šã€‚

å…¶å®åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬ç”¨äº†å¾ˆå¤š `VueUse` çš„æ–¹æ³•ï¼Œå®åœ¨æ˜¯å› ä¸ºå®ƒå¾ˆé¦™å•Šï¼Œç›®å‰æˆ‘ä»¬è¿˜æ²¡æœ‰å†™è¿‡ `hooks`ï¼Œå½“æˆ‘ä»¬åé¢å†™å†™ `hooks` ä¹‹åï¼Œä½ å†å›å¤´çœ‹çœ‹ `VueUse` åº“çš„ä¸€äº›æ–¹æ³•ï¼Œå°±ä¼šä½“ä¼šåˆ° `ComponsitionAPI` å’Œ `hooks` çš„ç²¾é«“äº†ã€‚æ²¡äº‹çš„è¯å¯ä»¥æ‰’æ‹‰ä¸€ä¸‹ `VueUse` åº“ï¼Œæ²¡ç”¨è¿‡çœ‹çœ‹æ–‡æ¡£ç†Ÿæ‚‰ä¸‹ï¼Œç”¨è¿‡çš„æŒ‘å…¶ä¸­ä¸€äº› `hooks` çš„æºç å­¦ä¹ å­¦ä¹ ï¼Œä¼šæœ‰å¾ˆå¤šæ”¶è·ï¼Œ`VueUse` ä¸­æ¯ä¸ª `hooks` çš„æºç å¹¶ä¸å¤æ‚ä¹Ÿä¸å¤šï¼Œé€‚åˆå…¥é—¨å­¦ä¹ ã€‚

## å¢åŠ è·¯ç”±è·³è½¬åŠ¨ç”»

æˆ‘ä»¬ç°åœ¨è·¯ç”±è·³è½¬å¤ªç”Ÿç¡¬äº†ï¼Œæ‰€ä»¥å’±ä»¬ä½¿ç”¨ `Vue` å†…ç½®çš„ `transition` ç»„ä»¶æ¥åšä¸ªè¿‡æ¸¡åŠ¨ç”»ã€‚

å®˜æ–¹æ–‡æ¡£ï¼š[transition ç»„ä»¶](https://cn.vuejs.org/guide/built-ins/transition.html#the-transition-component)

æ²¡ç”¨è¿‡çš„åŒå­¦èµ¶ç´§åˆ·ä¸‹æ–‡æ¡£ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥å†™äº†ï¼Œä¿®æ”¹å¯åˆ‡æ¢å¸ƒå±€ç»„ä»¶ `DefaultLayout` å’Œ `SidebarLayout`ï¼Œæ‰¾åˆ° router-view æ ‡ç­¾ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š

```html
<!-- ä¿®æ”¹å‰ -->
<router-view v-slot="{ Component }">
  <component :is="Component" />
</router-view>

<!-- ä¿®æ”¹å -->
<router-view v-slot="{ Component }">
  <transition name="fade-x">
    <component :is="Component" />
  </transition>
</router-view>
```

æ³¨æ„ï¼Œä¸¤ä¸ªå¸ƒå±€ä¸­éƒ½éœ€è¦æ”¹ã€‚

`transition` ç»„ä»¶ `name` å±æ€§æˆ‘ä»¬è®¾ç½®æˆ `fade-x`ï¼Œæ¥ä¸‹æ¥å†™ä¸‹è¿›å…¥ç¦»å¼€çš„è¿‡æ¸¡æ ·å¼ï¼ŒåŠ ä¸ªå¹³ç§»æ·¡å…¥å°±å¯ä»¥äº†ã€‚

è¿™ä¸ªè¿‡æ¸¡æ ·å¼åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­éƒ½å¯ä»¥ç”¨åˆ°ï¼Œå¹¶ä¸”åé¢è¯´ä¸å®šå“ªé‡Œä¹Ÿèƒ½ç”¨åˆ°ï¼Œæˆ‘ä»¬ç»™å®ƒå†™åˆ°å…¬å…±æ ·å¼ä¸­ã€‚

åœ¨ `src/assets` æ–‡ä»¶å¤¹ä¸‹æ–°å¢ `css/index.css` æ–‡ä»¶ï¼Œæš‚æ—¶å…ˆæŠŠå…¬å…±æ ·å¼å†™åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œå¦‚ä¸‹ï¼š

```css
/* è·¯ç”±è¿‡åº¦åŠ¨ç”» */
.fade-x-enter-active {
  transition: all 0.3s ease-out;
}
.fade-x-leave-active {
  transition: all 0;
}
.fade-x-enter-from {
  transform: translateX(20px);
  opacity: 0;
}
.fade-x-leave-from {
  opacity: 0;
}
```

åœ¨ `main.js` å…¥å£æ–‡ä»¶ä¸­å¼•å…¥ä¸‹å…¬å…±æ ·å¼ï¼š

```jsx
// å…¬å…±æ ·å¼
import '@/assets/css/index.css'

// ...
```

OKï¼Œä¿å­˜åˆ·æ–°é¡µé¢ï¼Œè·³è½¬ä¸‹è·¯ç”±å°±å¯ä»¥çœ‹åˆ°åˆ‡æ¢è·¯ç”±æ—¶æœ‰ä¸ªåœ†æ¶¦çš„å¹³ç§»æ·¡å…¥è¿‡æ¸¡åŠ¨ç”»äº†ã€‚

## éƒ¨éƒ¨éƒ¨éƒ¨ç½²ä¸‹

å› ä¸ºç»ˆäºå†™åˆ°äº†ä¸€ä¸ªåŠŸèƒ½é¡µé¢ï¼Œæ‰€ä»¥å¯ä»¥éƒ¨ç½²ä¸Šå»é¢„è§ˆäº†ï¼

æ²¡æœ‰éƒ¨ç½²æ•™ç¨‹ï¼Œå› ä¸ºç›®å‰è¿™å°±æ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼Œæ‰€ä»¥æˆ‘è¿™è¾¹ç›´æ¥ä½¿ç”¨ `docker nginx` é•œåƒéƒ¨ç½²äº†ä¸€ä¸ª `Web` æœåŠ¡ï¼Œå…¶å®å•¥éƒ½æ²¡æœ‰ï¼Œç›´æ¥ `build` æ„å»ºä¸‹ï¼Œç„¶åæŠŠæ„å»ºå¥½çš„é™æ€èµ„æºæ‰”ä¸Šå»å°±å¯ä»¥äº†ï¼Œå¤§å®¶å¯ä»¥è®¿é—®çœ‹çœ‹å•¥çš„ï¼ŒæœåŠ¡å™¨ä¸å¤ªè¡Œï¼Œç¨å¾®æœ‰ç‚¹æ…¢ï¼Œè‡ªåŠ¨åŒ–éƒ¨ç½²çš„æ•™ç¨‹å¾—åé¢é¡¹ç›®é™†ç»­å˜å¾—å¤æ‚äº†å†å†™ã€‚

å“¦ï¼Œè¿˜æ²¡ä¹°åŸŸåï¼Œæš‚æ—¶å°±å…ˆç”¨ä¸ªäºŒçº§åŸŸåå§ï¼ï¼ï¼

é¢„è§ˆåœ°å€ï¼š[http://toolsdog.isboyjc.com](http://toolsdog.isboyjc.com/)

å—¯ã€‚ã€‚ã€‚ä¹Ÿè¿˜æ²¡æ¥å¾—åŠæè¯ä¹¦ï¼ŒSoï¼Œä¸æ˜¯ `https` ç½‘ç«™ï¼Œæ‰€ä»¥ç¢äºæµè§ˆå™¨å®‰å…¨ç­–ç•¥ç›®å‰æ˜¯ä¸æ”¯æŒæˆ‘ä»¬ä¸Šé¢å†™çš„å¤åˆ¶åˆ°å‰ªåˆ‡æ¿çš„åŠŸèƒ½ï¼Œå›å¤´æˆ‘æœ‰ç©ºæä¸‹è¯ä¹¦å°±å¥½äº†ï¼

## å†™åœ¨æœ€å

å—¯ï¼Œå°±è¿™æ ·ï¼

æˆªæ­¢æœ¬æ–‡çš„ä»£ç å·²ç»æ‰“äº† `Tag` å‘å¸ƒï¼Œå¯ä¸‹è½½æŸ¥çœ‹ï¼š

ğŸ‘‰ğŸ» [toolsdog tag v0.0.4-dev](https://github.com/isboyjc/toolsdog/releases/tag/v0.0.4-dev)

ğŸ‘‰ğŸ» [é¡¹ç›® GitHub åœ°å€](https://github.com/isboyjc/toolsdog)